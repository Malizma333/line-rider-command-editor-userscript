"use strict";function setPlaybackDimensions(t){return{type:"SET_PLAYBACK_DIMENSIONS",payload:t}}function closeSidebar(){return{type:"SET_VIEWS",payload:{Sidebar:null},meta:{name:"SET_SIDEBAR_PAGE",auto:!1}}}class ComponentManager{constructor(t,e){this.rc=t,this.root=e,this.state=e.state,this.computed=e.computed}updateState(t){this.state=t}updateComputed(t){this.computed=t}main(){var{rc:t,state:e}=this;return t("div",{style:GLOBAL_STYLES.text},this.toolbar(),e.active&&t("div",{style:STYLES.content},e.settingsActive&&this.settingsContainer(),!e.settingsActive&&this.tabContainer(),!e.settingsActive&&this.windowContainer()))}toolbar(){const{rc:t,root:e,state:i}=this;return t("div",{style:STYLES.toolbar.container},t("button",{title:i.active?"Minimize":"Maximize",style:STYLES.button.embedded,onClick:()=>e.onActivate()},i.active?t("span",minimizeIcon):t("span",maximizeIcon)),i.active&&t("div",{style:Object.assign(Object.assign({},STYLES.toolbar.container),{justifyContent:"start"})},t("button",{title:"Download",style:STYLES.button.embedded,onClick:()=>e.onDownload()},t("span",downloadIcon)),t("button",{title:"Upload",style:STYLES.button.embedded,onClick:()=>{var t=document.getElementById("trigger-file-upload");t.value="",t.click()}},t("span",uploadIcon),t("input",{id:"trigger-file-upload",style:{display:"none"},type:"file",accept:".json",onChange:t=>e.onLoadFile(t.target.files[0])})),t("button",{title:"Load From Script",style:STYLES.button.embedded,onClick:()=>e.onLoadScript()},t("span",upRightArrowIcon)),t("button",{title:"Run",style:STYLES.button.embedded,onClick:()=>e.onTest()},t("span",playIcon)),t("button",{title:"Print to Console",style:STYLES.button.embedded,onClick:()=>e.onPrint()},t("span",printIcon))),i.active&&t("div",{style:Object.assign(Object.assign({},STYLES.toolbar.container),{justifyContent:"end"})},t("button",{title:"Undo",style:STYLES.button.embedded,disabled:0===e.computed.undoStack.length,onClick:()=>e.onUndo()},t("span",Object.assign(Object.assign({},leftArrowIcon),{style:{color:0===e.computed.undoStack.length?GLOBAL_STYLES.gray:GLOBAL_STYLES.black}}))),t("button",{title:"Redo",style:STYLES.button.embedded,disabled:0===e.computed.redoStack.length,onClick:()=>e.onRedo()},t("span",Object.assign(Object.assign({},rightArrowIcon),{style:{color:0===e.computed.redoStack.length?GLOBAL_STYLES.gray:GLOBAL_STYLES.black}}))),t("button",{title:"Settings",style:STYLES.button.embedded,onClick:()=>e.onToggleSettings(!i.settingsActive)},t("span",settingsIcon)),t("button",{title:"Report Issue",style:STYLES.button.embedded,onClick:()=>window.open(REPORT_LINK)},t("span",flagIcon)),t("button",{title:"Help",style:STYLES.button.embedded,onClick:()=>window.open(HELP_LINK)},t("span",helpIcon))))}settingsContainer(){var t=this["rc"];return t("div",{style:STYLES.settings.window},this.settingsHeader(),this.settings())}settingsHeader(){const{rc:t,root:e,state:i}=this;return t("div",{style:STYLES.settings.header},t("button",{style:Object.assign(Object.assign({},STYLES.button.embedded),{position:"absolute",fontSize:"32px",right:"0px"}),onClick:()=>e.onToggleSettings(!1)},t("span",xIcon)),t("text",{style:{fontSize:GLOBAL_STYLES.textSizes.L[i.settings.fontSize]}},"Settings"),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{position:"absolute",fontSize:GLOBAL_STYLES.textSizes.M[i.settings.fontSize],left:"0px",background:i.settingsDirty?GLOBAL_STYLES.light_gray3:GLOBAL_STYLES.dark_gray1}),disabled:!i.settingsDirty,onClick:()=>e.onApplySettings()},"Apply"))}settings(){const{rc:t,root:e,state:i}=this;return t(window.React.Fragment,{style:{fontSize:GLOBAL_STYLES.textSizes.M[i.settings.fontSize]}},t("div",{style:STYLES.settings.row},t("text",{style:Object.assign(Object.assign({},STYLES.settings.label),{fontSize:GLOBAL_STYLES.textSizes.S[i.settings.fontSize]})},"Font Sizes"),t("div",{style:Object.assign(Object.assign({},STYLES.settings.parameter),{fontSize:GLOBAL_STYLES.textSizes.S[i.settings.fontSize]})},t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.fontSize===SETTINGS.FONT_SIZES.SMALL?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeFontSize(SETTINGS.FONT_SIZES.SMALL)},t("text",null,"Small")),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.fontSize===SETTINGS.FONT_SIZES.MEDIUM?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeFontSize(SETTINGS.FONT_SIZES.MEDIUM)},t("text",null,"Medium")),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.fontSize===SETTINGS.FONT_SIZES.LARGE?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeFontSize(SETTINGS.FONT_SIZES.LARGE)},t("text",null,"Large")))),t("div",{style:STYLES.settings.row},t("text",{style:Object.assign(Object.assign({},STYLES.settings.label),{fontSize:GLOBAL_STYLES.textSizes.S[i.settings.fontSize]})},"Viewport"),t("div",{style:Object.assign(Object.assign({},STYLES.settings.parameter),{fontSize:GLOBAL_STYLES.textSizes.S[i.settings.fontSize]})},t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.resolution===SETTINGS.VIEWPORT.HD.ID?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeViewport(SETTINGS.VIEWPORT.HD.ID)},t("text",null,SETTINGS.VIEWPORT.HD.NAME)),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.resolution===SETTINGS.VIEWPORT.FHD.ID?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeViewport(SETTINGS.VIEWPORT.FHD.ID)},t("text",null,SETTINGS.VIEWPORT.FHD.NAME)),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.resolution===SETTINGS.VIEWPORT.QHD.ID?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeViewport(SETTINGS.VIEWPORT.QHD.ID)},t("text",null,SETTINGS.VIEWPORT.QHD.NAME)),t("button",{style:Object.assign(Object.assign({},STYLES.button.settings),{backgroundColor:i.unsavedSettings.resolution===SETTINGS.VIEWPORT.UHD.ID?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>e.onChangeViewport(SETTINGS.VIEWPORT.UHD.ID)},t("text",null,SETTINGS.VIEWPORT.UHD.NAME)))))}tabContainer(){const e=this["rc"];return e("div",{style:STYLES.tabs.container},Object.keys(TRIGGER_PROPS).map(t=>e("div",null,this.tab(t))))}tab(t){const{rc:e,root:i,state:r}=this;return e("button",{style:Object.assign(Object.assign({},STYLES.tabs.button),{backgroundColor:r.activeTab===t?GLOBAL_STYLES.light_gray1:GLOBAL_STYLES.dark_gray1}),onClick:()=>i.onChangeTab(t)},e("text",{style:{fontSize:GLOBAL_STYLES.textSizes.S[r.settings.fontSize]}},TRIGGER_PROPS[t].DISPLAY_NAME))}windowContainer(){var t=this["state"];return this.window(t.triggerData[t.activeTab])}window(e){var{rc:t,state:i}=this;return e.id===TRIGGER_TYPES.SKIN?t("div",{style:STYLES.window},this.skinEditorToolbar(e.triggers,i.skinEditorState.ddIndex),this.skinEditor(e)):t("div",{style:STYLES.window},this.smoothTab(i.triggerData[i.activeTab]),Object.keys(e.triggers).map(t=>this.trigger(e,parseInt(t,10))))}smoothTab(e){const{rc:t,root:i,state:r}=this;return t("div",{style:STYLES.smooth.container},t("label",{for:"smoothTextInput",style:{fontSize:GLOBAL_STYLES.textSizes.S[r.settings.fontSize]}},"Smoothing"),e.id!==TRIGGER_TYPES.TIME&&t("input",{id:"smoothTextInput",style:Object.assign(Object.assign({},STYLES.smooth.input),{fontSize:GLOBAL_STYLES.textSizes.S[r.settings.fontSize],marginLeft:"5px"}),value:e.smoothing,onChange:t=>i.onUpdateTrigger({prev:e.smoothing,new:t.target.value},["smoothing"],CONSTRAINTS.SMOOTH),onBlur:t=>i.onUpdateTrigger({prev:e.smoothing,new:t.target.value},["smoothing"],CONSTRAINTS.SMOOTH,!0)}),e.id===TRIGGER_TYPES.TIME&&t("div",{style:STYLES.checkbox.container},t("input",{id:"smoothTextInput",style:STYLES.checkbox.primary,type:"checkbox",onChange:()=>i.onUpdateTrigger({prev:r.triggerData[r.activeTab].interpolate,new:!r.triggerData[r.activeTab].interpolate},["interpolate"],CONSTRAINTS.INTERPOLATE)}),e.interpolate&&t("square",{style:STYLES.checkbox.fill})))}trigger(t,e){const{rc:i,root:r,state:s}=this;var n=t.triggers[e];return i("div",{style:Object.assign(Object.assign({},STYLES.trigger.container),{fontSize:GLOBAL_STYLES.textSizes.M[s.settings.fontSize],backgroundColor:0===e?GLOBAL_STYLES.gray:GLOBAL_STYLES.white})},i("button",{style:Object.assign(Object.assign({},STYLES.button.embedded),{fontSize:"22px",position:"absolute",right:"0px"}),disabled:0===e,onClick:()=>r.onDeleteTrigger(e)},i("span",Object.assign(Object.assign({},xIcon),{style:{color:0===e?GLOBAL_STYLES.dark_gray2:GLOBAL_STYLES.black}}))),this.timeStamp(n[0],e),t.id===TRIGGER_TYPES.ZOOM&&this.zoomTrigger(n,e),t.id===TRIGGER_TYPES.PAN&&this.cameraPanTrigger(n,e),t.id===TRIGGER_TYPES.FOCUS&&this.cameraFocusTrigger(n,e),t.id===TRIGGER_TYPES.TIME&&this.timeRemapTrigger(n,e),t.id===TRIGGER_TYPES.SKIN&&!1,i("button",{style:STYLES.trigger.createButton,onClick:()=>r.onCreateTrigger(e)},i("span",plusIcon)))}timeStamp(t,r){const{rc:s,root:n,computed:a}=this,o=[CONSTRAINTS.MINUTE,CONSTRAINTS.SECOND,CONSTRAINTS.FRAME];return!!Array.isArray(t)&&s("div",{style:STYLES.trigger.property},t.map((e,i)=>s("div",null,s("text",{style:STYLES.trigger.text},["Time",":",":"][i]),s("input",{style:Object.assign(Object.assign({},STYLES.trigger.input),{color:a.invalidTimes[r]?"red":"black"}),value:e,onChange:t=>n.onUpdateTrigger({prev:e,new:t.target.value},["triggers",r,0,i],o[i]),onBlur:t=>n.onUpdateTrigger({prev:e,new:t.target.value},["triggers",r,0,i],o[i],!0)}))))}zoomTrigger(e,i){const{rc:t,root:r}=this;var s=["Zoom To"];return t("div",{style:STYLES.trigger.property},t("label",{for:`triggerText_${s[0]}_`+i,style:STYLES.trigger.text},s[0]),t("input",{id:`triggerText_${s[0]}_`+i,style:STYLES.trigger.input,value:e[1],onChange:t=>r.onUpdateTrigger({prev:e[1],new:t.target.value},["triggers",i,1],CONSTRAINTS.ZOOM),onBlur:t=>r.onUpdateTrigger({prev:e[1],new:t.target.value},["triggers",i,1],CONSTRAINTS.ZOOM,!0)}))}cameraPanTrigger(s,n){const{rc:a,root:o}=this,l=[CONSTRAINTS.PAN_WIDTH,CONSTRAINTS.PAN_HEIGHT,CONSTRAINTS.PAN_X,CONSTRAINTS.PAN_Y],g=["Width","Height","Offset X","Offset Y"];return a(window.React.Fragment,null,[["w","h"],["x","y"]].map((t,r)=>a("div",{style:{display:"flex",flexDirection:"row"}},t.map((e,i)=>a("div",{style:STYLES.trigger.property},a("label",{for:`triggerText_${g[i+2*r]}_`+n,style:STYLES.trigger.text},g[i+2*r]),a("input",{id:`triggerText_${g[i+2*r]}_`+n,style:STYLES.trigger.input,value:s[1][e],onChange:t=>o.onUpdateTrigger({prev:s[1][e],new:t.target.value},["triggers",n,1,e],l[i+2*r]),onBlur:t=>o.onUpdateTrigger({prev:s[1][e],new:t.target.value},["triggers",n,1,e],l[i+2*r],!0)}))))))}cameraFocusTrigger(e,i){const{rc:r,root:s,state:t}=this,n=t.focusDDIndices[i];var a=["Weight"];return r("div",{style:STYLES.trigger.property},r("select",{style:STYLES.dropdown.head,value:n,onChange:t=>s.onChangeFocusDD(i,t.target.value)},Object.keys(e[1]).map(t=>{var e=1+parseInt(t,10);return r("option",{style:STYLES.dropdown.option,value:parseInt(t,10)},r("text",null,"Rider "+e))})),r("label",{for:`triggerText_${a[0]}_${n}_`+i,style:STYLES.trigger.text},a[0]),r("input",{id:`triggerText_${a[0]}_${n}_`+i,style:STYLES.trigger.input,value:e[1][n],onChange:t=>s.onUpdateTrigger({prev:e[1][n],new:t.target.value},["triggers",i,1,n],CONSTRAINTS.FOCUS_WEIGHT),onBlur:t=>s.onUpdateTrigger({prev:e[1][n],new:t.target.value},["triggers",i,1,n],CONSTRAINTS.FOCUS_WEIGHT,!0)}))}timeRemapTrigger(e,i){const{rc:t,root:r}=this;var s=["Speed"];return t("div",{style:STYLES.trigger.property},t("label",{for:`triggerText_${s[0]}_`+i,style:STYLES.trigger.text},s[0]),t("input",{id:`triggerText_${s[0]}_`+i,style:STYLES.trigger.input,value:e[1],onChange:t=>r.onUpdateTrigger({prev:e[1],new:t.target.value},["triggers",i,1],CONSTRAINTS.TIME_SPEED),onBlur:t=>r.onUpdateTrigger({prev:e[1],new:t.target.value},["triggers",i,1],CONSTRAINTS.TIME_SPEED,!0)}))}skinEditor(t){const{rc:e,root:i,state:r}=this,s=r.skinEditorState["ddIndex"];return e("div",{style:STYLES.skinEditor.container},e("div",{style:STYLES.skinEditor.background}),e("div",{id:"skinElementContainer",style:Object.assign(Object.assign({},STYLES.skinEditor.canvas),{transform:`scale(${r.skinEditorState.zoom.scale})`,transformOrigin:`${r.skinEditorState.zoom.xOffset}px ${r.skinEditorState.zoom.yOffset}px`}),onWheel:t=>i.onZoomSkinEditor(t,!0)},this.flagSvg(t.triggers[s],s),e("svg",{width:"10vw"}),this.riderSvg(t.triggers[s],s)),e("div",{style:STYLES.skinEditor.zoomContainer},e("input",{style:{height:"10px"},type:"range",orient:"vertical",min:CONSTRAINTS.SKIN_ZOOM.MIN,max:CONSTRAINTS.SKIN_ZOOM.MAX,step:.1,value:r.skinEditorState.zoom.scale,onChange:t=>i.onZoomSkinEditor(t,!1)}),e("text",{style:{fontSize:GLOBAL_STYLES.textSizes.S[r.settings.fontSize]}},"x"+Math.round(10*r.skinEditorState.zoom.scale)/10)),e("div",{style:STYLES.skinEditor.outlineColor.container},e("text",{style:{fontSize:GLOBAL_STYLES.textSizes.S[r.settings.fontSize]}},"Outline"),e("div",{style:Object.assign(Object.assign({},STYLES.skinEditor.outlineColor.input),{backgroundColor:t.triggers[s].outline.stroke}),onClick:()=>i.onUpdateTrigger({new:r.skinEditorState.color},["triggers",s,"outline","stroke"])})))}skinEditorToolbar(t,e){const{rc:i,root:r,state:s}=this;var n=s.skinEditorState.color.substring(0,7),a=parseInt(s.skinEditorState.color.substring(7),16)/255;return i("div",{style:STYLES.skinEditor.toolbar},i("button",{style:Object.assign(Object.assign({},STYLES.button.embedded),{fontSize:"32px",position:"absolute",right:"10px"}),onClick:()=>r.onResetSkin(e)},i("span",trashIcon)),i("div",{style:Object.assign(Object.assign(Object.assign({},STYLES.skinEditor.toolbarItem),STYLES.alpha.container),{fontSize:GLOBAL_STYLES.textSizes.S[s.settings.fontSize]})},i("label",{for:"alphaSlider"},"Transparency"),i("div",{style:STYLES.alpha.sliderContainer},i("input",{id:"alphaSlider",style:STYLES.alpha.slider,type:"range",min:CONSTRAINTS.ALPHA_SLIDER.MIN,max:CONSTRAINTS.ALPHA_SLIDER.MAX,step:.01,value:a,onChange:t=>r.onChangeColor(null,t.target.value)}))),i("input",{style:Object.assign(Object.assign({},STYLES.skinEditor.toolbarItem),{height:"40px",width:"40px"}),type:"color",value:n,onChange:t=>r.onChangeColor(t.target.value,null)}),i("select",{style:Object.assign(Object.assign(Object.assign({},STYLES.skinEditor.toolbarItem),STYLES.dropdown.head),{fontSize:GLOBAL_STYLES.textSizes.M[s.settings.fontSize]}),value:e,onChange:t=>r.onChangeSkinDD(t.target.value)},Object.keys(t).map(t=>{var e=1+parseInt(t,10);return i("option",{style:STYLES.dropdown.option,value:parseInt(t,10)},i("text",null,"Rider "+e))})))}flagSvg(t,e){const{rc:i,root:r,state:s}=this,n=s.skinEditorState["color"];return i("svg",{style:STYLES.skinEditor.flagSvg},i("path",Object.assign(Object.assign({},STYLES.riderProps.flag),{fill:t.flag.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"flag","fill"])})),i("path",Object.assign(Object.assign({},STYLES.riderProps.flagOutline),{fill:t.flag.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"flag","fill"])})))}riderSvg(t,e){const{rc:i,root:r,state:s}=this,n=s.skinEditorState["color"];return i("svg",{style:STYLES.skinEditor.riderSvg},i("rect",Object.assign(Object.assign({},STYLES.riderProps.skin),{fill:t.skin.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"skin","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.nose),{stroke:t.outline.stroke,fill:t.skin.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"skin","fill"])})),i("rect",Object.assign(Object.assign({},STYLES.riderProps.hair),{fill:t.hair.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"hair","fill"])})),i("rect",Object.assign(Object.assign({},STYLES.riderProps.faceOutline),{fill:t.hair.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"hair","fill"])})),i("rect",Object.assign(Object.assign({},STYLES.riderProps.hairFill),{fill:t.fill.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"fill","fill"])})),i("polygon",Object.assign(Object.assign({},STYLES.riderProps.eye),{fill:t.eye.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"eye","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.sled),{stroke:t.outline.stroke,fill:t.sled.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"sled","fill"])})),i("line",Object.assign(Object.assign({},STYLES.riderProps.string),{stroke:t.string.stroke,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"string","stroke"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.armHand),{stroke:t.outline.stroke,fill:t.armHand.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"armHand","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.legPants),{stroke:t.outline.stroke,fill:t.legPants.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"legPants","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.legFoot),{stroke:t.outline.stroke,fill:t.legFoot.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"legFoot","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfEven),STYLES.riderProps.id_scarf0a),{fill:t.id_scarf0.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf0","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfEven),STYLES.riderProps.id_scarf0b),{fill:t.id_scarf0.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf0","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfOdd),STYLES.riderProps.id_scarf1),{fill:t.id_scarf1.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf1","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfOdd),STYLES.riderProps.id_scarf2),{fill:t.id_scarf2.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf2","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfOdd),STYLES.riderProps.id_scarf3),{fill:t.id_scarf3.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf3","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfOdd),STYLES.riderProps.id_scarf4),{fill:t.id_scarf4.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf4","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.id_scarfOdd),STYLES.riderProps.id_scarf5),{fill:t.id_scarf5.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"id_scarf5","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.torso),{stroke:t.outline.stroke,fill:t.torso.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"torso","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.scarfOdd),STYLES.riderProps.scarf1),{fill:t.scarf1.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"scarf1","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.scarfOdd),STYLES.riderProps.scarf2),{fill:t.scarf2.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"scarf2","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.scarfOdd),STYLES.riderProps.scarf3),{fill:t.scarf3.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"scarf3","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.scarfOdd),STYLES.riderProps.scarf4),{fill:t.scarf4.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"scarf4","fill"])})),i("rect",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.scarfOdd),STYLES.riderProps.scarf5),{fill:t.scarf5.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"scarf5","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.hatTop),{stroke:t.outline.stroke,fill:t.hatTop.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"hatTop","fill"])})),i("path",Object.assign(Object.assign({},STYLES.riderProps.hatBottom),{stroke:t.hatBottom.stroke,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"hatBottom","stroke"])})),i("circle",Object.assign(Object.assign({},STYLES.riderProps.hatBall),{fill:t.hatBall.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"hatBall","fill"])})),i("path",Object.assign(Object.assign(Object.assign({},STYLES.riderProps.outline),STYLES.riderProps.armSleeve),{stroke:t.outline.stroke,fill:t.armSleeve.fill,onClick:()=>r.onUpdateTrigger({new:n},["triggers",e,"armSleeve","fill"])})))}}const ROOT_NODE_ID="COMMAND_EDITOR_ROOT_NODE",HELP_LINK="https://github.com/Malizma333/line-rider-command-editor-userscript#readme",REPORT_LINK="https://github.com/Malizma333/line-rider-command-editor-userscript/issues/new",FPS=40,SETTINGS={VIEWPORT:{HD:{ID:"HD",NAME:"720p",SIZE:[1280,720]},FHD:{ID:"FHD",NAME:"1080p",SIZE:[1920,1080]},QHD:{ID:"QHD",NAME:"1440p",SIZE:[2560,1440]},UHD:{ID:"UHD",NAME:"4K",SIZE:[3840,2160]}},FONT_SIZES:{SMALL:0,MEDIUM:1,LARGE:2}};var TRIGGER_TYPES,TYPES;!function(t){t.ZOOM="ZOOM",t.PAN="CAMERA_PAN",t.FOCUS="CAMERA_FOCUS",t.TIME="TIME_REMAP",t.SKIN="CUSTOM_SKIN"}(TRIGGER_TYPES=TRIGGER_TYPES||{});const TRIGGER_PROPS={[TRIGGER_TYPES.ZOOM]:{DISPLAY_NAME:"Zoom",TEMPLATE:[[0,0,0],1],FUNC:"getAutoZoom = createZoomer({0},{1});"},[TRIGGER_TYPES.PAN]:{DISPLAY_NAME:"Pan",TEMPLATE:[[0,0,0],{w:.4,h:.4,x:0,y:0}],FUNC:"getCamBounds = createBoundsPanner({0},{1});"},[TRIGGER_TYPES.FOCUS]:{DISPLAY_NAME:"Focus",TEMPLATE:[[0,0,0],[1]],FUNC:"getCamFocus = createFocuser({0},{1});"},[TRIGGER_TYPES.TIME]:{DISPLAY_NAME:"Speed",TEMPLATE:[[0,0,0],1],FUNC:"timeRemapper = createTimeRemapper({0},{1});"},[TRIGGER_TYPES.SKIN]:{DISPLAY_NAME:"Skin",TEMPLATE:{outline:{stroke:"black"},flag:{fill:"#00000066"},skin:{fill:"white"},hair:{fill:"black"},fill:{fill:"black"},eye:{fill:"black"},sled:{fill:"white"},string:{stroke:"black"},armSleeve:{fill:"black"},armHand:{fill:"white"},legPants:{fill:"black"},legFoot:{fill:"white"},torso:{fill:"white"},hatTop:{fill:"white"},hatBottom:{stroke:"black"},hatBall:{fill:"black"},scarf1:{fill:"#FD4F38"},scarf2:{fill:"white"},scarf3:{fill:"#06A725"},scarf4:{fill:"white"},scarf5:{fill:"#3995FD"},id_scarf0:{fill:"white"},id_scarf1:{fill:"#FD4F38"},id_scarf2:{fill:"white"},id_scarf3:{fill:"#06A725"},id_scarf4:{fill:"white"},id_scarf5:{fill:"#3995FD"}},FUNC:"setCustomRiders({0});",STYLE_MAP:{outline:".outline",flag:".flag",skin:".skin",hair:".hair",fill:".fill",eye:"#eye",sled:".sled",string:"#string",armSleeve:".arm.sleeve",armHand:".arm.hand",legPants:".leg.pants",legFoot:".leg.foot",torso:".torso",hatTop:".hat.top",hatBottom:".hat.bottom",hatBall:".hat.ball",scarf1:".scarf1",scarf2:".scarf2",scarf3:".scarf3",scarf4:".scarf4",scarf5:".scarf5",id_scarf0:"#scarf0",id_scarf1:"#scarf1",id_scarf2:"#scarf2",id_scarf3:"#scarf3",id_scarf4:"#scarf4",id_scarf5:"#scarf5"}}},downloadIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>'}},upRightArrowIcon={dangerouslySetInnerHTML:{__html:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-corner-up-right"><polyline points="15 14 20 9 15 4"></polyline><path d="M4 20v-7a4 4 0 0 1 4-4h12"></path></svg>'}},playIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>'}},printIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>'}},uploadIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>'}},settingsIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>'}},flagIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path><line x1="4" y1="22" x2="4" y2="15"></line></svg>'}},helpIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'}},minimizeIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"></path></svg>'}},maximizeIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>'}},plusIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>'}},plusCircleIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>'}},xIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>'}},trashIcon={dangerouslySetInnerHTML:{__html:'<svg style="display: block" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>'}},leftArrowIcon={dangerouslySetInnerHTML:{__html:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>'}},rightArrowIcon={dangerouslySetInnerHTML:{__html:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>'}};function InitRoot(){const{store:a,React:t}=window,n=document.getElementById(ROOT_NODE_ID);return class o extends t.Component{constructor(){super(),this.state={active:!1,initialized:!1,activeTab:TRIGGER_TYPES.ZOOM,triggerData:{},focusDDIndices:[0],skinEditorState:{ddIndex:0,zoom:{scale:1},color:"#000000ff"},settingsActive:!1,settingsDirty:!1,settings:{fontSize:SETTINGS.FONT_SIZES.MEDIUM,resolution:SETTINGS.VIEWPORT.HD.ID},unsavedSettings:{fontSize:SETTINGS.FONT_SIZES.MEDIUM,resolution:SETTINGS.VIEWPORT.HD.ID}},this.computed={invalidTimes:[],riderCount:1,undoStack:[],redoStack:[]},this.componentManager=new ComponentManager(t.createElement,this),this.parser=new ScriptParser,a.subscribe(()=>this.updateStore(a.getState()))}static clampedSkinDD(t,e){let i=e["ddIndex"];return e.ddIndex>=t&&(i=t-1),Object.assign(Object.assign({},e),{ddIndex:i})}static resizedSkinArray(t,e){var i=e[TRIGGER_TYPES.SKIN].triggers,r=i.length;return r<t&&i.push(...Array(t-r).fill(structuredClone(TRIGGER_PROPS[TRIGGER_TYPES.SKIN].TEMPLATE))),t<r&&i.splice(t,r-t),e[TRIGGER_TYPES.SKIN].triggers=i,e}static resizedFocusWeightArrays(r,t){const s=t[TRIGGER_TYPES.FOCUS].triggers;return s.forEach((t,e)=>{var i=s[e][1].length;i<r&&s[e][1].push(...Array(r-i).fill(0)),r<i&&s[e][1].splice(r,i-r)}),t[TRIGGER_TYPES.FOCUS].triggers=s,t}static clampedFocusDDs(e,t){const i=[];return t.forEach(t=>{i.push(Math.min(e-1,t))}),i}static resizedFocusDDIndexArray(t,e){var i=[...e],e=e.length;return e<t&&i.push(...Array(t-e).fill(0)),t<e&&i.splice(t,e-t),i}static chosenFocusDDIndices(t,e){const r=[...e];return t[TRIGGER_TYPES.FOCUS].triggers.forEach((e,t)=>{let i=0;for(let t=0;t<e[1].length;t+=1)if(0!==e[1][t]){i=t;break}r[t]=i}),r}static savedViewport(t,e,i){const r=i,s=Math.log2(SETTINGS.VIEWPORT[e].SIZE[0]/SETTINGS.VIEWPORT[t].SIZE[0]);i=SETTINGS.VIEWPORT[e].SIZE;return a.dispatch(setPlaybackDimensions({width:i[0],height:i[1]})),r[TRIGGER_TYPES.ZOOM].triggers.forEach((t,e)=>{r[TRIGGER_TYPES.ZOOM].triggers[e][1]=Math.round(1e7*(r[TRIGGER_TYPES.ZOOM].triggers[e][1]+s+Number.EPSILON))/1e7}),r}componentDidMount(){Object.assign(n.style,STYLES.root),window.save_commands=()=>(this.onDownload(),"Downloaded commands!"),this.onInit().then(()=>{this.setState({initialized:!0})}).catch(t=>{console.error(t.message)})}pushAction(t,e){this.computed.undoStack.push(t),this.computed.redoStack.length=0}async onInit(){const e={};Object.keys(TRIGGER_PROPS).forEach(t=>{switch(e[t]={id:t,triggers:[structuredClone(TRIGGER_PROPS[t].TEMPLATE)]},t){case TRIGGER_TYPES.FOCUS:case TRIGGER_TYPES.PAN:case TRIGGER_TYPES.ZOOM:e[t].smoothing=CONSTRAINTS.SMOOTH.DEFAULT;break;case TRIGGER_TYPES.TIME:e[t].interpolate=CONSTRAINTS.INTERPOLATE.DEFAULT}}),this.setState({triggerData:e})}onCreateTrigger(t){var{triggerData:e,activeTab:i,focusDDIndices:r}=this.state,s=e[i],s=structuredClone(s.triggers[t]),n=getPlayerIndex(a.getState());s[0]=[Math.floor(n/2400),Math.floor(n%2400/40),Math.floor(n%40)],e[i].triggers.splice(t+1,0,s),i===TRIGGER_TYPES.FOCUS&&this.setState({focusDDIndices:o.resizedFocusDDIndexArray(e[i].triggers.length,r)}),this.pushAction(this.state.triggerData,e),this.setState({triggerData:e})}onUpdateTrigger(t,e,i,r=!1){var{triggerData:s,activeTab:n}=this.state;let a=s[n];for(let t=0;t<e.length-1;t+=1)a=a[e[t]];a[e[e.length-1]]=validateData(t,i,r),this.pushAction(this.state.triggerData,s),this.setState({triggerData:s})}onDeleteTrigger(i){var{triggerData:t,activeTab:e,focusDDIndices:r}=this.state;t[e].triggers=t[e].triggers.filter((t,e)=>i!==e),e===TRIGGER_TYPES.FOCUS&&this.setState({focusDDIndices:o.resizedFocusDDIndexArray(t[e].triggers.length,r)}),this.pushAction(this.state.triggerData,t),this.setState({triggerData:t})}onDownload(){var t=document.createElement("a"),e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.state.triggerData));t.setAttribute("href",e),t.setAttribute("download",getTrackTitle(a.getState())+".scriptData.json"),t.click(),t.remove()}onLoadFile(t){const e=new window.FileReader;e.onload=()=>{var t=JSON.parse(e.result);this.onLoad(t)},e.readAsText(t)}onLoadScript(){this.onLoad(this.parser.parseScript(getCurrentScript(a.getState())))}onLoad(i){try{const r=i;Object.keys(i).forEach(t=>{var e;void 0===r[t]?r[t]=i[t]:t===TRIGGER_TYPES.FOCUS&&(e=[...this.state.focusDDIndices],e=o.resizedFocusDDIndexArray(r[t].triggers.length,e),e=o.chosenFocusDDIndices(r,e),this.setState({focusDDIndices:e}))}),this.pushAction(this.state.triggerData,r),this.setState({triggerData:r})}catch(t){console.error(t.message)}}onTest(){var{activeTab:t,triggerData:e}=this.state;try{var i=generateScript(t,e);eval.call(window,i)}catch(t){console.error(t.message)}}onPrint(){var{activeTab:t,triggerData:e}=this.state;try{console.info(generateScript(t,e))}catch(t){console.error(t.message)}}onUndo(){var t=this.computed.undoStack.pop();this.computed.redoStack.push(t),this.setState({triggerData:t})}onRedo(){var t=this.computed.redoStack.pop();this.computed.undoStack.push(t),this.setState({triggerData:t})}onResetSkin(t){var e=this.state["triggerData"];window.confirm("Are you sure you want to reset the current rider's skin?")&&(e[TRIGGER_TYPES.SKIN].triggers[t]=structuredClone(TRIGGER_PROPS[TRIGGER_TYPES.SKIN].TEMPLATE),this.pushAction(this.state.triggerData,e),this.setState({triggerData:e}))}onChangeColor(t,e){e=null!=e?Math.round(255*Math.min(Math.max(parseFloat(e),0),1)).toString(16).padStart(2,"0"):this.state.skinEditorState.color.substring(7),t=null!=t?t+e:this.state.skinEditorState.color.substring(0,7)+e;this.setState({skinEditorState:Object.assign(Object.assign({},this.state.skinEditorState),{color:t})})}onActivate(){var t=this.state["active"],e=getSidebarOpen(a.getState());!t&&e&&a.dispatch(closeSidebar()),this.setState({active:!t})}onChangeTab(t){this.setState({activeTab:t})}onToggleSettings(t){var{settingsDirty:e,settings:i}=this.state;if(!t&&e){if(!window.confirm("Discard changes?"))return;this.setState({unsavedSettings:i}),this.setState({settingsDirty:!1})}this.setState({settingsActive:t})}onChangeFontSize(t){var{unsavedSettings:e,settings:i}=this.state;t!==i.fontSize&&this.setState({settingsDirty:!0}),this.setState({unsavedSettings:Object.assign(Object.assign({},e),{fontSize:t})})}onChangeViewport(t){var{unsavedSettings:e,settings:i}=this.state;t!==i.resolution&&this.setState({settingsDirty:!0}),this.setState({unsavedSettings:Object.assign(Object.assign({},e),{resolution:t})})}onApplySettings(){var{triggerData:t,settings:e,unsavedSettings:i}=this.state,e=o.savedViewport(e.resolution,i.resolution,t);this.pushAction(this.state.triggerData,e),this.setState({triggerData:e}),this.setState({settingsDirty:!1}),this.setState({settings:Object.assign({},i)})}onChangeFocusDD(t,e){var i=[...this.state.focusDDIndices];i[t]=parseInt(e,10),this.setState({focusDDIndices:i})}onChangeSkinDD(t){this.setState({skinEditorState:Object.assign(Object.assign({},this.state.skinEditorState),{ddIndex:parseInt(t,10)})})}onZoomSkinEditor(t,e){var i=this.state["skinEditorState"],r=document.getElementById("skinElementContainer").getBoundingClientRect();let{scale:s,xOffset:n,yOffset:a}=i.zoom;s=e?(i.zoom.scale<CONSTRAINTS.SKIN_ZOOM.MAX&&(n=(t.clientX-r.x)/i.zoom.scale,a=(t.clientY-r.y)/i.zoom.scale),Math.max(Math.min(i.zoom.scale-.001*t.deltaY,CONSTRAINTS.SKIN_ZOOM.MAX),CONSTRAINTS.SKIN_ZOOM.MIN)):Math.max(Math.min(t.target.value,CONSTRAINTS.SKIN_ZOOM.MAX),CONSTRAINTS.SKIN_ZOOM.MIN),this.setState({skinEditorState:Object.assign(Object.assign({},this.state.skinEditorState),{zoom:Object.assign(Object.assign({},this.state.skinEditorState.zoom),{xOffset:n,yOffset:a,scale:s})})})}updateComputed(){var{triggerData:t,activeTab:e}=this.state;e!==TRIGGER_TYPES.SKIN&&(this.computed.invalidTimes=validateTimes(t[e]))}updateStore(t){var e=getNumRiders(t),i=(this.computed.riderCount!==e&&(this.computed.riderCount=e,{triggerData:r,skinEditorState:s,focusDDIndices:i}=this.state,r=o.resizedFocusWeightArrays(e,r),r=o.resizedSkinArray(e,r),s=o.clampedSkinDD(e,s),e=o.clampedFocusDDs(e,i),this.pushAction(this.state.triggerData,r),this.setState({triggerData:r}),this.setState({skinEditorState:s}),this.setState({focusDDIndices:e})),getSidebarOpen(t)),r=(i&&this.setState({active:!1}),getPlayerRunning(t)),s=getWindowFocused(t),e=window.CMD_EDITOR_DEBUG||!r&&s;n.style.opacity=e?"1":"0",n.style.pointerEvents=e?"auto":"none"}render(){var t=this.state["initialized"];return!!t&&(this.updateComputed(),this.componentManager.updateState(this.state),this.componentManager.updateComputed(this.computed),this.componentManager.main())}}}function generateScript(t,e){var i=e[t],r=TRIGGER_PROPS[t].FUNC;switch(t){case TRIGGER_TYPES.FOCUS:case TRIGGER_TYPES.PAN:case TRIGGER_TYPES.ZOOM:return r.replace("{0}",JSON.stringify(i.triggers)).replace("{1}",i.smoothing).replace(" ","");case TRIGGER_TYPES.TIME:return r.replace("{0}",JSON.stringify(i.triggers)).replace("{1}",i.interpolate).replace(" ","");case TRIGGER_TYPES.SKIN:return r.replace("{0}",formatSkins(i.triggers)).replace(" ","");default:return""}}function formatSkins(t){var e,t=t.map(t=>[` .outline {stroke: ${t.outline.stroke}}`,` .skin {fill: ${t.skin.fill}}`,` .hair {fill: ${t.hair.fill}}`,` .fill {fill: ${t.fill.fill}}`,` #eye {fill: ${t.eye.fill}}`,` .sled {fill: ${t.sled.fill}}`,` #string {stroke: ${t.string.stroke}}`,` .arm .sleeve {fill: ${t.armSleeve.fill}}`,` .arm .hand {fill: ${t.armHand.fill}}`,` .leg .pants {fill: ${t.legPants.fill}}`,` .leg .foot {fill: ${t.legFoot.fill}}`,` .torso {fill: ${t.torso.fill}}`,` .scarf1 {fill: ${t.scarf1.fill}}`,` .scarf2 {fill: ${t.scarf2.fill}}`,` .scarf3 {fill: ${t.scarf3.fill}}`,` .scarf4 {fill: ${t.scarf4.fill}}`,` .scarf5 {fill: ${t.scarf5.fill}}`,` #scarf0 {fill: ${t.id_scarf0.fill}}`,` #scarf1 {fill: ${t.id_scarf1.fill}}`,` #scarf2 {fill: ${t.id_scarf2.fill}}`,` #scarf3 {fill: ${t.id_scarf3.fill}}`,` #scarf4 {fill: ${t.id_scarf4.fill}}`,` #scarf5 {fill: ${t.id_scarf5.fill}}`,` .hat .top {fill: ${t.hatTop.fill}}`,` .hat .bottom {stroke: ${t.hatBottom.stroke}}`,` .hat .ball {fill: ${t.hatBall.fill}}`,` .flag {fill: ${t.flag.fill}}`].join("").replace(/\n/g,""));return t.unshift(null!=(e=t.pop())?e:""),JSON.stringify(t)}class ScriptParser{parseScript(t){this.triggerData={};const i=t.replace(/\s/g,"");return Object.keys(TRIGGER_PROPS).forEach(e=>{try{this.parseCommand(e,i)}catch(t){console.error("[ScriptParser]",t.message),void 0!==this.triggerData[e]&&(this.triggerData[e]=void 0)}}),this.triggerData}parseCommand(commandId,scriptSection){const currentHeader=TRIGGER_PROPS[commandId].FUNC.split("(")[0],currentHeaderIndex=scriptSection.indexOf(currentHeader);if(-1!==currentHeaderIndex){this.initCommand(commandId);const startIndex=currentHeaderIndex+currentHeader.length+1;let endIndex=startIndex;for(let i=1;0<i||endIndex>=scriptSection.length;endIndex+=1)"("===scriptSection.charAt(endIndex+1)&&(i+=1),")"===scriptSection.charAt(endIndex+1)&&--i;const parameterText=`[${this.removeLeadingZeroes(scriptSection.substring(startIndex,endIndex),commandId)}]`,parameterArray=eval(parameterText),[keyframes,smoothing]=parameterArray;switch(commandId){case TRIGGER_TYPES.ZOOM:case TRIGGER_TYPES.PAN:case TRIGGER_TYPES.FOCUS:case TRIGGER_TYPES.TIME:this.parseTriggers(commandId,keyframes),this.parseSmoothing(commandId,smoothing);break;case TRIGGER_TYPES.SKIN:this.parseSkinCss(keyframes)}}}initCommand(t){switch(this.triggerData[t]={id:t,triggers:[]},t){case TRIGGER_TYPES.FOCUS:case TRIGGER_TYPES.PAN:case TRIGGER_TYPES.ZOOM:this.triggerData[t].smoothing=CONSTRAINTS.SMOOTH.DEFAULT;break;case TRIGGER_TYPES.TIME:this.triggerData[t].interpolate=CONSTRAINTS.INTERPOLATE.DEFAULT}}parseTriggers(e,i){for(let t=0;t<i.length;t+=1){this.triggerData[e].triggers.push([...i[t]]);var r,s=i[t][0];"number"==typeof s?this.triggerData[e].triggers[t][0]=this.retrieveTimestamp(s):1===s.length?(r=s[0],this.triggerData[e].triggers[t][0]=this.retrieveTimestamp(r)):2===s.length?(r=s[0]*FPS+s[1],this.triggerData[e].triggers[t][0]=this.retrieveTimestamp(r)):(s=s[0]*FPS*60+s[1]*FPS+s[2],this.triggerData[e].triggers[t][0]=this.retrieveTimestamp(s))}}parseSmoothing(t,e){if(t===TRIGGER_TYPES.TIME){var i=CONSTRAINTS.INTERPOLATE;if(null==e)this.triggerData[t].interpolate=i.DEFAULT;else{if(!0!==e&&!1!==e)throw new Error("Invalid boolean!");this.triggerData[t].interpolate=e}}else{i=CONSTRAINTS.SMOOTH;if(null==e)this.triggerData[t].interpolate=i.DEFAULT;else{if("number"!=typeof e)throw new Error("Invalid integer!");e>i.MAX?this.triggerData[t].smoothing=i.MAX:e<i.MIN?this.triggerData[t].smoothing=i.MIN:this.triggerData[t].smoothing=e}}}parseSkinCss(t){t.forEach((e,i)=>{this.triggerData[TRIGGER_TYPES.SKIN].triggers.push(structuredClone(TRIGGER_PROPS[TRIGGER_TYPES.SKIN].TEMPLATE));let r=0,s=0;for(let t=0;t<e.length;t+=1)"{"===e.charAt(t)&&(r+=1),"}"===e.charAt(t)&&0===--r&&(this.parseSkinProp(e.substring(s,t+1).replace(/\s/g,""),i),s=t+1)}),this.triggerData[TRIGGER_TYPES.SKIN].triggers.push(this.triggerData[TRIGGER_TYPES.SKIN].triggers.shift())}parseSkinProp(i,r){const s=/(['"])?([#]?[a-z0-9A-Z_-]+)(['"])?/g;var t=TRIGGER_PROPS[TRIGGER_TYPES.SKIN].STYLE_MAP;Object.entries(t).forEach(([t,e])=>{i.startsWith(e)&&(void 0!==(e=JSON.parse(i.substring(e.length).replace(s,'"$2"').replace(";",","))).fill&&(this.triggerData[TRIGGER_TYPES.SKIN].triggers[r][t].fill=e.fill),void 0!==e.stroke)&&(this.triggerData[TRIGGER_TYPES.SKIN].triggers[r][t].stroke=e.stroke)})}retrieveTimestamp(t){var e=t%FPS,i=Math.floor(t/FPS)%60;return[Math.floor(t/(60*FPS)),i,e]}removeLeadingZeroes(t,e){return e===TRIGGER_TYPES.SKIN?t:t.replace(/([^\d.+-])0+(\d+)/g,"$1$2")}}function getSimulatorTrack(t){return t.simulator.engine}function getWindowFocused(t){return t.views.Main}function getPlayerRunning(t){return t.player.running}function getCurrentScript(t){return t.trackData.script}function getRiders(t){return getSimulatorTrack(t).engine.state.riders}function getNumRiders(t){return getRiders(t).length}function getPlayerIndex(t){return t.player.index}function getSidebarOpen(t){return t.views.Sidebar}function getTrackTitle(t){return t.trackData.label}const GLOBAL_STYLES={black:"#000000",dark_gray1:"#b7b7b7",dark_gray2:"#999999",dark_gray3:"#666666",dark_gray4:"#434343",gray:"#cccccc",light_gray1:"#d9d9d9",light_gray2:"#efefef",light_gray3:"#f3f3f3",white:"#ffffff",text:{fontFamily:"Helvetica",fontWeight:"bold"},textSizes:{S:["12px","14px","18px"],M:["18px","22px","24px"],L:["28px","32px","36px"]},centerX:{left:"0px",right:"0px",marginLeft:"auto",marginRight:"auto"}},STYLES={root:{backgroundColor:GLOBAL_STYLES.light_gray3,border:"2px solid black",left:"50px",opacity:0,overflow:"hidden",padding:"1vh",pointerEvents:"none",position:"fixed",top:"12.5px"},content:{alignItems:"center",display:"flex",height:"60vh",flexDirection:"column",justifyContent:"center",paddingTop:"1vh",width:"40vw"},button:{embedded:{alignItems:"center",background:"none",border:"none",display:"flex",height:"1.5em",justifyContent:"center",userSelect:"none",width:"1.5em"},filled:{alignItems:"center",backgroundColor:GLOBAL_STYLES.white,border:"2px solid black",display:"flex",height:"1.5em",justifyContent:"center",userSelect:"none",width:"1.5em"},settings:{border:"2px solid black",borderRadius:"5px",margin:"5px"}},toolbar:{container:{alignItems:"start",display:"flex",flex:1,fontSize:"25px",width:"100%"}},settings:{window:{backgroundColor:GLOBAL_STYLES.white,border:"2px solid black",display:"flex",flexDirection:"column",flex:9,overflow:"auto",position:"relative",width:"100%"},header:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:"3em",margin:"10px",position:"relative"},row:{alignItems:"center",display:"flex",flexDirection:"row",height:"1.5em",minHeight:"3em",padding:"1em"},label:{position:"absolute",left:"5px"},parameter:{position:"absolute",right:"5px"}},tabs:{container:{alignItems:"end",display:"flex",justifyContent:"start",flexDirection:"row",overflowX:"auto",width:"100%"},button:{border:"2px solid black",borderBottom:"0px solid black",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"}},smooth:{container:{alignItems:"center",backgroundColor:GLOBAL_STYLES.white,borderBottom:"1px solid black",display:"flex",height:"3em",justifyContent:"start",padding:".5em"},input:{backgroundColor:GLOBAL_STYLES.white,overflow:"hidden",textAlign:"center",width:"3em"}},checkbox:{container:{alignItems:"center",display:"flex",height:"20px",justifyContent:"center",marginLeft:"5px",position:"relative",width:"20px"},primary:{appearance:"none",background:"#FFF",border:"2px solid black",height:"100%",position:"absolute",width:"100%"},fill:{backgroundColor:"#000",height:"60%",pointerEvents:"none",position:"absolute",width:"60%"}},window:{backgroundColor:GLOBAL_STYLES.white,border:"2px solid black",display:"flex",flexDirection:"column",flex:9,overflowY:"scroll",width:"100%"},trigger:{container:{alignItems:"start",border:"1px solid black",display:"flex",flexDirection:"column",padding:"12px",position:"relative"},property:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start",marginBottom:"0.25em",width:"100%",whiteSpace:"nowrap"},input:{height:"2ch",padding:"5px",textAlign:"right",width:"3em"},text:{margin:"0em .5em"},createButton:Object.assign(Object.assign({},GLOBAL_STYLES.centerX),{alignItems:"center",backgroundColor:GLOBAL_STYLES.white,bottom:"-0.75em",border:"2px solid black",display:"flex",fontSize:"18px",height:"1.5em",justifyContent:"center",position:"absolute",userSelect:"none",width:"1.5em",zIndex:1})},dropdown:{head:{height:"3ch",marginRight:"10px",textAlign:"right"},option:{height:"2ch",textAlign:"center"}},skinEditor:{container:{alignItems:"center",display:"flex",flex:5,justifyContent:"center",overflow:"hidden",position:"relative",userSelect:"none",width:"100%"},background:{background:"linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%), linear-gradient(-45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%)",backgroundSize:"10px 10px",height:"100vh",position:"absolute",transform:"rotate(45deg)",width:"100vw"},toolbar:{alignItems:"center",backgroundColor:GLOBAL_STYLES.light_gray1,borderBottom:"3px solid black",flex:1,display:"flex",justifyContent:"left",position:"relative",userSelect:"none"},toolbarItem:{margin:"0px 5px"},canvas:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%"},outlineColor:{container:{alignItems:"center",display:"flex",position:"absolute",bottom:"10px",left:"10px"},input:{border:"1px solid black",borderRadius:"10px",height:"20px",marginLeft:"5px",width:"20px"}},zoomContainer:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"center",left:"20px",position:"absolute",top:"20px",height:"0px"},flagSvg:{height:"18",transform:"scale(5)",width:"15"},riderSvg:{height:"25",transform:"scale(5)",width:"31"}},alpha:{container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"},sliderContainer:{alignItems:"center",display:"flex",position:"relative"},slider:{appearance:"none",background:"linear-gradient(to left, black, white)",border:"1px solid black",borderRadius:"5px",height:"8px",margin:"5px",marginTop:"10px",opacity:.7,width:"100px"}},riderProps:{outline:{strokeWidth:.3},flag:{transform:"translate(-5, -3)",d:"M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3Z"},flagOutline:{transform:"translate(-5, -3)",d:"M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3M7,7.25V11.5C7,11.5 9,10 11,10C13,10 14,12 16,12C18,12 18,11 18,11V7.5C18,7.5 17,8 16,8C14,8 13,6 11,6C9,6 7,7.25 7,7.25Z"},skin:{transform:"translate(13,8) rotate(-90)",width:"3.1",height:"4.5"},hair:{transform:"translate(12.4, 5.15) rotate(-90)",width:"0.3",height:"5.1"},faceOutline:{transform:"translate(12.2, 8.1) rotate(-90)",width:"3.1",height:"0.3"},hairFill:{transform:"translate(12.2,4.2) scale(0.8,0.8)",width:"3.1",height:"4.8"},eye:{transform:"translate(16.3,6.7)",points:"0.4,-0.4 0,-0.5 -0.4,-0.4 -0.5,0 -0.4,0.4 0,0.5 0.4,0.4 0.5,0"},nose:{transform:"translate(17.3,8.1) rotate(-90)",d:"M 0 -0.25 v 0.4 c 0.1 1.3 1.2 1.2 3.1 0 v -0.4"},sled:{transform:"translate(9.7, 15.9) scale(1.04,1)",d:"M13.6-2.2c-1.35,0-2.55,0.75-3.15,1.85H0C-0.2-0.35-0.35-0.2-0.35,0S-0.2,0.35,0,0.35h1.75V4.4H-0.2c-0.2,0-0.35,0.15-0.35,0.35S-0.4,5.1-0.2,5.1h13.8c2,0,3.65-1.65,3.65-3.65S15.6-2.2,13.6-2.2zM9.05,4.4h-6.6V0.35h6.6V4.4z M13.6,4.4H9.75V0.35h0.35C10.05,0.5,10,0.7,10,0.9c0,0.2,0.15,0.35,0.35,0.35c0.15,0,0.3-0.1,0.35-0.25c0.05-0.2,0.1-0.45,0.2-0.65h0.9c0.2,0,0.35-0.15,0.35-0.35S12-0.35,11.8-0.35h-0.5c0.5-0.7,1.35-1.15,2.3-1.15c1.65,0,2.95,1.3,2.95,2.95C16.55,3.1,15.25,4.4,13.6,4.4z"},string:{transform:"translate(21.5, 10.5) rotate(40)",x1:"0",y1:"0",x2:"8",y2:"0",strokeWidth:"0.3"},armSleeve:{transform:"translate(15, 10) rotate(5)",d:"M5,0.7H0c-0.4,0-0.7-0.3-0.7-0.7S-0.4-0.7,0-0.7h5"},armHand:{transform:"translate(15, 10) rotate(5)",d:"M5-0.7h0.5c0,0,0.3-0.7,0.5-0.6c0.2,0.1,0,0.6,0,0.6s0.4,0,0.6,0c0.2,0,0.5,0.3,0.5,0.7c0,0.4-0.2,0.7-0.5,0.7c-0.5,0-1.6,0-1.6,0"},legPants:{transform:"translate(15, 16) rotate(45)",d:"M4.8-0.7H0c-0.4,0-0.7,0.3-0.7,0.7S-0.4,0.7,0,0.7h4.8"},legFoot:{transform:"translate(15, 16) rotate(45)",d:"M4.8,0.7h2.4l0-2.7L6.7-2L6-0.7H4.8"},torso:{transform:"translate(16.9, 8.1) rotate(90)",width:"7.8",height:"4.4"},scarfEven:{transform:"translate(14.8, 15.2) rotate(-90)"},scarfOdd:{transform:"translate(14.8, 15.2) rotate(-90)"},scarf1:{strokeWidth:"0",x:"5.2",y:"1.5",width:"2",height:"1"},scarf2:{strokeWidth:"0",x:"5.2",y:"0.5",width:"2",height:"1"},scarf3:{strokeWidth:"0",x:"5.2",y:"-0.5",width:"2",height:"1"},scarf4:{strokeWidth:"0",x:"5.2",y:"-1.5",width:"2",height:"1"},scarf5:{strokeWidth:"0",x:"5.2",y:"-2.5",width:"2",height:"1"},hatTop:{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",d:"M11-2.6h-0.4v5.2H11c1.2,0,2.2-1.2,2.2-2.6S12.2-2.6,11-2.6z"},hatBottom:{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",strokeWidth:1,strokeLinecap:"round",d:"M10.6-2.6 v5.2"},hatBall:{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",cx:"13.9",cy:"0",r:"0.7"},id_scarfEven:{transform:"translate(10.5, 8.5)"},id_scarfOdd:{transform:"translate(10.5, 8.5)"},id_scarf0a:{strokeWidth:"0",x:"2",width:"2",height:"2"},id_scarf0b:{strokeWidth:"0",x:"0",width:"2",height:"2"},id_scarf1:{strokeWidth:"0",x:"-2",width:"2",height:"2"},id_scarf2:{strokeWidth:"0",x:"-4",width:"2",height:"2"},id_scarf3:{strokeWidth:"0",x:"-6",width:"2",height:"2"},id_scarf4:{strokeWidth:"0",x:"-8",width:"2",height:"2"},id_scarf5:{strokeWidth:"0",x:"-10",width:"2",height:"2"}}},CONSTRAINTS=(!function(t){t.BOOL="BOOLEAN",t.INT="INTEGER",t.FLOAT="FLOAT"}(TYPES=TYPES||{}),{INTERPOLATE:{DEFAULT:!0,TYPE:TYPES.BOOL},SMOOTH:{DEFAULT:20,MIN:0,MAX:40,TYPE:TYPES.INT},FRAME:{DEFAULT:0,MIN:0,MAX:39,TYPE:TYPES.INT},SECOND:{DEFAULT:0,MIN:0,MAX:59,TYPE:TYPES.INT},MINUTE:{DEFAULT:0,MIN:0,MAX:99,TYPE:TYPES.INT},ZOOM:{DEFAULT:1,MIN:-50,MAX:50,TYPE:TYPES.FLOAT},PAN_X:{DEFAULT:0,MIN:-100,MAX:100,TYPE:TYPES.FLOAT},PAN_Y:{DEFAULT:0,MIN:-100,MAX:100,TYPE:TYPES.FLOAT},PAN_WIDTH:{DEFAULT:.4,MIN:0,MAX:2,TYPE:TYPES.FLOAT},PAN_HEIGHT:{DEFAULT:.4,MIN:0,MAX:2,TYPE:TYPES.FLOAT},FOCUS_WEIGHT:{DEFAULT:0,MIN:0,MAX:1,TYPE:TYPES.FLOAT},TIME_SPEED:{DEFAULT:1,MIN:.01,MAX:10,TYPE:TYPES.FLOAT},SKIN_ZOOM:{DEFAULT:1,MIN:1,MAX:4,TYPE:TYPES.FLOAT},ALPHA_SLIDER:{DEFAULT:1,MIN:0,MAX:1,TYPE:TYPES.FLOAT}});function validateData(t,e,i){if(null==e)return t.new;switch(e.TYPE){case TYPES.BOOL:return t.new;case TYPES.INT:return validateInteger(t,e,i);case TYPES.FLOAT:return validateFloat(t,e,i);default:return t.prev}}function validateInteger(t,e,i){var r,s=t.prev,t=t.new;return""===t.trim()?0:(r=Math.floor(Number(t)),Number.isNaN(r)||t.includes(".")?s:i?r<e.MIN?e.MIN:r>e.MAX?e.MAX:r:r)}function validateFloat(t,e,i){var r,s=t.prev,t=t.new;return""===t.trim()?0:(r=Number(t),Number.isNaN(r)?s:i?r<e.MIN?e.MIN:r>e.MAX?e.MAX:r:t.includes(".")?t:r)}function validateTimes(t){if(null==t)return[];var e=t["triggers"],i=Array(e.length).map(()=>!1),t=e[0][0];0===t[0]&&0===t[1]&&0===t[2]||(i[0]=!0);for(let t=0;t<e.length-1;t+=1){var r=e[t][0],s=e[t+1][0],r=(60*r[0]+r[1])*FPS+r[2];(60*s[0]+s[1])*FPS+s[2]<=r&&(i[t+1]=!0)}return i}function main(){var{React:t,ReactDOM:e}=window,i=document.createElement("div");i.setAttribute("id",ROOT_NODE_ID),document.getElementById("content").appendChild(i),e.render(t.createElement(InitRoot()),i)}if(null!=window.store)main();else{const prevInit=window.onAppReady;window.onAppReady=()=>{null!=prevInit&&prevInit(),main()}}
