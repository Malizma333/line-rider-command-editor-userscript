(()=>{"use strict";var __webpack_modules__={449:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>readJsScript});var _lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(925),_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(406),_lib_validation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(733);function readJsScript(scriptText,currentTriggerData){const triggerData=_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.G.initialTriggerData;function parseCommand(commandId,scriptSection){if(commandId===_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.GRAVITY)throw new Error("Gravity parsing not supported!");if(void 0===_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.B[commandId].FUNC)throw new Error("Function undefined!");const currentHeader=_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.B[commandId].FUNC.split("(")[0],currentHeaderIndex=scriptSection.indexOf(currentHeader);if(-1===currentHeaderIndex)throw new Error("Command header not found!");const startIndex=currentHeaderIndex+currentHeader.length+1;let endIndex=startIndex;for(let e=1;e>0||endIndex>=scriptSection.length;endIndex+=1)"("===scriptSection.charAt(endIndex+1)&&(e+=1),")"===scriptSection.charAt(endIndex+1)&&(e-=1);const parameterText=`[${removeLeadingZeroes(scriptSection.substring(startIndex,endIndex),commandId)}]`,parameterArray=eval(parameterText),[keyframes,smoothing]=parameterArray;switch(commandId){case _lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.ZOOM:case _lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.PAN:case _lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.FOCUS:case _lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.TIME:parseTriggers(commandId,keyframes),parseSmoothing(commandId,smoothing);break;case _lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN:parseSkinCss(keyframes)}}function parseTriggers(e,t){const r=[];for(let e=0;e<t.length;e+=1){r.push(structuredClone(t[e]));const i=t[e][0];if("number"==typeof i){const t=i;r[e][0]=retrieveTimestamp(t)}else if(1===i.length){const t=i[0];r[e][0]=retrieveTimestamp(t)}else if(2===i.length){const t=40*i[0]+i[1];r[e][0]=retrieveTimestamp(t)}else{const t=2400*i[0]+40*i[1]+i[2];r[e][0]=retrieveTimestamp(t)}}triggerData[e].triggers=r}function parseSmoothing(e,t){if(e===_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.TIME){const r=_lib_validation__WEBPACK_IMPORTED_MODULE_2__.v.INTERPOLATE;if(null==t)return void(triggerData[e].interpolate=r.DEFAULT);if(!0!==t&&!1!==t)throw new Error("Invalid boolean!");triggerData[e].interpolate=t}else{const r=_lib_validation__WEBPACK_IMPORTED_MODULE_2__.v.SMOOTH;if(null==t)return void(triggerData[e].smoothing=r.DEFAULT);if("number"!=typeof t)throw new Error("Invalid integer!");t>r.MAX?triggerData[e].smoothing=r.MAX:t<r.MIN?triggerData[e].smoothing=r.MIN:triggerData[e].smoothing=t}}function parseSkinCss(e){var t;e.forEach(((e,t)=>{triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers.push(structuredClone(_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.B[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].TEMPLATE));let r=0,i=0;for(let n=0;n<e.length;n+=1)"{"===e.charAt(n)&&(r+=1),"}"===e.charAt(n)&&(r-=1,0===r&&(parseSkinProp(e.substring(i,n+1).replace(/\s/g,""),t),i=n+1))})),triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers.length>0&&triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers.push(null!==(t=triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers.shift())&&void 0!==t?t:_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.B[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].TEMPLATE)}function parseSkinProp(e,t){const r=/(['"])?([#]?[a-z0-9A-Z_-]+)(['"])?/g,i=triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers;Object.entries({outline:".outline",flag:".flag",skin:".skin",hair:".hair",fill:".fill",eye:"#eye",sled:".sled",string:"#string",armSleeve:".arm.sleeve",armHand:".arm.hand",legPants:".leg.pants",legFoot:".leg.foot",torso:".torso",hatTop:".hat.top",hatBottom:".hat.bottom",hatBall:".hat.ball",scarf1:".scarf1",scarf2:".scarf2",scarf3:".scarf3",scarf4:".scarf4",scarf5:".scarf5",id_scarf0:"#scarf0",id_scarf1:"#scarf1",id_scarf2:"#scarf2",id_scarf3:"#scarf3",id_scarf4:"#scarf4",id_scarf5:"#scarf5"}).forEach((([n,a])=>{if(!e.startsWith(a))return;const o=JSON.parse(e.substring(a.length).replace(r,'"$2"').replace(";",","));void 0!==o.fill&&(i[t][n].fill=o.fill),void 0!==o.stroke&&(i[t][n].stroke=o.stroke)})),triggerData[_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN].triggers=i}function retrieveTimestamp(e){const t=e%40,r=Math.floor(e/40)%60;return[Math.floor(e/2400),r,t]}function removeLeadingZeroes(e,t){return t===_lib_TriggerDataManager_types__WEBPACK_IMPORTED_MODULE_1__.n.SKIN?e:e.replace(/([^\d.+-])0+(\d+)/g,"$1$2")}const trimmedScript=scriptText.replace(/\s/g,"");return Object.keys(_lib_TriggerDataManager__WEBPACK_IMPORTED_MODULE_0__.B).forEach((e=>{try{triggerData[e].triggers=[],parseCommand(e,trimmedScript)}catch(t){t instanceof Error&&(console.warn(`[ScriptParser.parseScript()] ${t.message}`),triggerData[e]=structuredClone(currentTriggerData[e]))}})),triggerData}},925:(e,t,r)=>{r.d(t,{B:()=>a,G:()=>o});var i=r(733),n=r(406);const a={[n.n.ZOOM]:{DISPLAY_NAME:"Zoom",FUNC:"getAutoZoom=createZoomer({0},{1});",TEMPLATE:[[0,0,0],1]},[n.n.PAN]:{DISPLAY_NAME:"Pan",FUNC:"getCamBounds=createBoundsPanner({0},{1});",TEMPLATE:[[0,0,0],{w:.4,h:.4,x:0,y:0}]},[n.n.FOCUS]:{DISPLAY_NAME:"Focus",FUNC:"getCamFocus=createFocuser({0},{1});",TEMPLATE:[[0,0,0],[1]]},[n.n.TIME]:{DISPLAY_NAME:"Speed",FUNC:"timeRemapper=createTimeRemapper({0},{1});",TEMPLATE:[[0,0,0],1]},[n.n.SKIN]:{DISPLAY_NAME:"Skin",FUNC:"setCustomRiders({0});",TEMPLATE:{outline:{stroke:"black"},flag:{fill:"#00000066"},skin:{fill:"white"},hair:{fill:"black"},fill:{fill:"black"},eye:{fill:"black"},sled:{fill:"white"},string:{stroke:"black"},armSleeve:{fill:"black"},armHand:{fill:"white"},legPants:{fill:"black"},legFoot:{fill:"white"},torso:{fill:"white"},hatTop:{fill:"white"},hatBottom:{stroke:"black"},hatBall:{fill:"black"},scarf1:{fill:"#FD4F38"},scarf2:{fill:"white"},scarf3:{fill:"#06A725"},scarf4:{fill:"white"},scarf5:{fill:"#3995FD"},id_scarf0:{fill:"white"},id_scarf1:{fill:"#FD4F38"},id_scarf2:{fill:"white"},id_scarf3:{fill:"#06A725"},id_scarf4:{fill:"white"},id_scarf5:{fill:"#3995FD"}}},[n.n.GRAVITY]:{DISPLAY_NAME:"Gravity",TEMPLATE:[[0,0,0],[{x:0,y:.175}]]}};class o{constructor(){this.triggerData=o.initialTriggerData,this.undoStack=[],this.redoStack=[]}static get initialTriggerData(){return{[n.n.ZOOM]:{id:n.n.ZOOM,triggers:[structuredClone(a[n.n.ZOOM].TEMPLATE)],smoothing:i.v.SMOOTH.DEFAULT},[n.n.PAN]:{id:n.n.PAN,triggers:[structuredClone(a[n.n.PAN].TEMPLATE)],smoothing:i.v.SMOOTH.DEFAULT},[n.n.FOCUS]:{id:n.n.FOCUS,triggers:[structuredClone(a[n.n.FOCUS].TEMPLATE)],smoothing:i.v.SMOOTH.DEFAULT},[n.n.TIME]:{id:n.n.TIME,triggers:[structuredClone(a[n.n.TIME].TEMPLATE)],interpolate:i.v.INTERPOLATE.DEFAULT},[n.n.SKIN]:{id:n.n.SKIN,triggers:[structuredClone(a[n.n.SKIN].TEMPLATE)]},[n.n.GRAVITY]:{id:n.n.GRAVITY,triggers:[structuredClone(a[n.n.GRAVITY].TEMPLATE)]}}}get data(){return this.triggerData}get undoLen(){return this.undoStack.length}get redoLen(){return this.redoStack.length}updateRiderCount(e){const t=this.triggerData[n.n.FOCUS].triggers;for(const r of t){const t=r[1].length;t<e&&r[1].push(...Array(e-t).fill(0)),t>e&&r[1].splice(e,t-e)}this.triggerData[n.n.FOCUS].triggers=t;const r=this.triggerData[n.n.GRAVITY].triggers;for(const t of r){const r=t[1].length;r<e&&t[1].push(...Array(e-r).fill(null).map((()=>({x:0,y:.175})))),r>e&&t[1].splice(e,r-e)}this.triggerData[n.n.GRAVITY].triggers=r;const i=this.triggerData[n.n.SKIN].triggers,o=i.length;o<e&&i.push(...Array(e-o).fill(null).map((()=>structuredClone(a[n.n.SKIN].TEMPLATE)))),o>e&&i.splice(e,o-e),this.triggerData[n.n.SKIN].triggers=i}updateFromPath(e,t,r){this.redoStack=[];const i=this.setAtPointer(e,t);this.undoStack.push({modificationPath:e,oldValue:i,activeTab:r}),this.undoStack.length>30&&this.undoStack.shift()}undo(){const e=this.undoStack.pop();if(void 0===e)return null;const{modificationPath:t,oldValue:r,activeTab:i}=e,n=this.setAtPointer(t,r);return this.redoStack.push({modificationPath:t,oldValue:n,activeTab:i}),i}redo(){const e=this.redoStack.pop();if(void 0===e)return null;const{modificationPath:t,oldValue:r,activeTab:i}=e,n=this.setAtPointer(t,r);return this.undoStack.push({modificationPath:t,oldValue:n,activeTab:i}),i}setAtPointer(e,t){let r=this.triggerData;for(let t=0;t<e.length-1;t+=1)r=r[e[t]];const i=r[e[e.length-1]];return r[e[e.length-1]]=t,i}}},406:(e,t,r)=>{var i;r.d(t,{n:()=>i}),function(e){e.ZOOM="ZOOM",e.PAN="CAMERA_PAN",e.FOCUS="CAMERA_FOCUS",e.TIME="TIME_REMAP",e.SKIN="CUSTOM_SKIN",e.GRAVITY="GRAVITY"}(i||(i={}))},733:(e,t,r)=>{r.d(t,{P:()=>n,v:()=>i});const i={INTERPOLATE:{DEFAULT:!0},SMOOTH:{DEFAULT:20,MIN:0,MAX:40,INT:!0},FRAME:{DEFAULT:0,MIN:0,MAX:39,INT:!0},SECOND:{DEFAULT:0,MIN:0,MAX:59,INT:!0},MINUTE:{DEFAULT:0,MIN:0,MAX:99,INT:!0},ZOOM:{DEFAULT:1,MIN:-50,MAX:50,INT:!1},PAN_X:{DEFAULT:0,MIN:-100,MAX:100,INT:!1},PAN_Y:{DEFAULT:0,MIN:-100,MAX:100,INT:!1},PAN_WIDTH:{DEFAULT:.4,MIN:0,MAX:2,INT:!1},PAN_HEIGHT:{DEFAULT:.4,MIN:0,MAX:2,INT:!1},FOCUS_WEIGHT:{DEFAULT:0,MIN:0,MAX:1,INT:!1},TIME_SPEED:{DEFAULT:1,MIN:.01,MAX:10,INT:!1},SKIN_ZOOM:{DEFAULT:1,MIN:1,MAX:4,INT:!1},ALPHA_SLIDER:{DEFAULT:1,MIN:0,MAX:1,INT:!1},GRAVITY_X:{DEFAULT:.175,MIN:-100,MAX:100,INT:!1},GRAVITY_Y:{DEFAULT:0,MIN:-100,MAX:100,INT:!1}};function n(e){const t=Array(e.length).map((()=>!1)),r=e[0][0];0===r[0]&&0===r[1]&&0===r[2]||(t[0]=!0);for(let r=0;r<e.length-1;r+=1){const i=e[r][0],n=e[r+1][0];40*(60*i[0]+i[1])+i[2]>=40*(60*n[0]+n[1])+n[2]&&(t[r+1]=!0)}return t}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e,t,r;!function(e){e.VIEWPORT="VIEWPORT",e.FONT_SIZE="FONT_SIZE"}(e||(e={})),function(e){e[e.HD=0]="HD",e[e.FHD=1]="FHD",e[e.QHD=2]="QHD",e[e.UHD=3]="UHD"}(t||(t={})),function(e){e[e.SMALL=0]="SMALL",e[e.MEDIUM=1]="MEDIUM",e[e.LARGE=2]="LARGE"}(r||(r={}));const i={black:"#000000",dark_gray1:"#b7b7b7",dark_gray2:"#999999",dark_gray3:"#666666",dark_gray4:"#434343",gray:"#cccccc",light_gray1:"#d9d9d9",light_gray2:"#efefef",light_gray3:"#f3f3f3",white:"#ffffff",text:{fontFamily:"Helvetica",fontWeight:"bold"},textSizes:{S:{[r.SMALL]:"12px",[r.MEDIUM]:"14px",[r.LARGE]:"18px"},M:{[r.SMALL]:"18px",[r.MEDIUM]:"22px",[r.LARGE]:"24px"},L:{[r.SMALL]:"28px",[r.MEDIUM]:"32px",[r.LARGE]:"36px"}},centerX:{left:"0px",right:"0px",marginLeft:"auto",marginRight:"auto"}},n={root:{backgroundColor:i.light_gray3,transition:"opacity 225ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",border:"2px solid black",left:"50px",opacity:0,overflow:"hidden",padding:"1vh",pointerEvents:"none",position:"fixed",top:"12.5px"},content:{alignItems:"center",display:"flex",height:"clamp(250px, 60vh, 450px)",flexDirection:"column",justifyContent:"center",paddingTop:"1vh",width:"clamp(425px, 40vw, 650px)"},toolbar:{container:{alignItems:"start",display:"flex",flex:1,fontSize:"25px",width:"100%"}},settings:{window:{backgroundColor:i.white,border:"2px solid black",display:"flex",flexDirection:"column",flex:9,overflow:"auto",position:"relative",width:"100%"},header:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:"3em",margin:"10px",position:"relative"},row:{alignItems:"center",display:"flex",flexDirection:"row",height:"1.5em",minHeight:"3em",padding:"1em"},label:{position:"absolute",left:"5px"},parameter:{position:"absolute",right:"5px"}},tabs:{container:{alignItems:"end",display:"flex",justifyContent:"start",flexDirection:"row",overflowX:"auto",width:"100%"},button:{border:"2px solid black",borderBottom:"0px solid black",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"}},smooth:{container:{alignItems:"center",backgroundColor:i.white,borderBottom:"1px solid black",display:"flex",height:"3em",justifyContent:"start",padding:".5em"},input:{backgroundColor:i.white,overflow:"hidden",textAlign:"center",width:"3em",marginLeft:"5px"}},checkbox:{container:{alignItems:"center",display:"flex",height:"20px",justifyContent:"center",marginLeft:"5px",position:"relative",width:"20px"},primary:{appearance:"none",background:"#FFF",border:"2px solid black",height:"100%",position:"absolute",width:"100%"},fill:{backgroundColor:"#000",height:"60%",pointerEvents:"none",position:"absolute",width:"60%"}},window:{backgroundColor:i.white,border:"2px solid black",display:"flex",flexDirection:"column",flex:9,overflowY:"scroll",width:"100%"},trigger:{container:{alignItems:"start",border:"1px solid black",display:"flex",flexDirection:"column",padding:"12px",position:"relative"},buttonContainer:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",position:"absolute",right:"5px"},property:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"start",marginBottom:"0.25em",width:"100%",whiteSpace:"nowrap"},input:{height:"2ch",padding:"5px",textAlign:"right",width:"3em"},text:{margin:"0em .5em"},createButton:Object.assign(Object.assign({},i.centerX),{alignItems:"center",backgroundColor:i.white,bottom:"-0.75em",border:"2px solid black",display:"flex",fontSize:"18px",height:"1.5em",justifyContent:"center",position:"absolute",userSelect:"none",width:"1.5em",zIndex:1})},dropdown:{head:{height:"3ch",marginRight:"10px",textAlign:"right"},option:{height:"2ch",textAlign:"center"}},skinEditor:{container:{alignItems:"center",display:"flex",flex:5,justifyContent:"center",overflow:"hidden",position:"relative",userSelect:"none",width:"100%"},background:{background:"linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%), linear-gradient(-45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%)",backgroundSize:"10px 10px",height:"100vh",position:"absolute",transform:"rotate(45deg)",width:"100vw"},toolbar:{alignItems:"center",backgroundColor:i.white,borderBottom:"3px solid black",flex:1,display:"flex",justifyContent:"left",position:"relative",userSelect:"none"},toolbarItem:{margin:"0px 5px"},canvas:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%"},outlineColor:{container:{alignItems:"center",display:"flex",position:"absolute",bottom:"10px",left:"10px"},input:{border:"1px solid black",borderRadius:"10px",height:"20px",marginLeft:"5px",width:"20px"}},zoomContainer:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"center",left:"20px",position:"absolute",top:"20px",height:"0px"}},alpha:{container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"},sliderContainer:{alignItems:"center",display:"flex",position:"relative"},slider:{appearance:"none",background:"linear-gradient(to left, black, white)",border:"1px solid black",borderRadius:"5px",height:"8px",margin:"5px",marginTop:"10px",opacity:.7,width:"100px"}},riderProps:{outline:{strokeWidth:.3},scarfEven:{transform:"translate(14.8, 15.2) rotate(-90)",width:"2",height:"1",strokeWidth:"0",x:"5.2"},scarfOdd:{transform:"translate(14.8, 15.2) rotate(-90)",width:"2",height:"1",strokeWidth:"0",x:"5.2"},id_scarfEven:{transform:"translate(10.5, 8.5)",strokeWidth:"0",width:"2",height:"2"},id_scarfOdd:{transform:"translate(10.5, 8.5)",strokeWidth:"0",width:"2",height:"2"}}};var a=__webpack_require__(925),o=__webpack_require__(406),s=__webpack_require__(449),l=__webpack_require__(733);function c(e,t){const r=a.G.initialTriggerData;function i(e,t){const i=[];for(const r of t){const t=structuredClone(r),n=r[0];if("number"==typeof n){const e=n;t[0]=s(e)}else if(1===n.length){const e=n[0];t[0]=s(e)}else if(2===n.length){const e=40*n[0]+n[1];t[0]=s(e)}else{const e=2400*n[0]+40*n[1]+n[2];t[0]=s(e)}e===o.n.GRAVITY&&void 0===t[1].length&&(t[1]=[t[1]]),i.push(t)}r[e].triggers=i}function n(e,t){if(e===o.n.TIME){const i=l.v.INTERPOLATE;if(null==t)return void(r[e].interpolate=i.DEFAULT);if(!0!==t&&!1!==t)throw new Error("Invalid boolean!");r[e].interpolate=t}else{const i=l.v.SMOOTH;if(null==t)return void(r[e].smoothing=i.DEFAULT);if("number"!=typeof t)throw new Error("Invalid integer!");t>i.MAX?r[e].smoothing=i.MAX:t<i.MIN?r[e].smoothing=i.MIN:r[e].smoothing=t}}function s(e){const t=e%40,r=Math.floor(e/40)%60;return[Math.floor(e/2400),r,t]}return Object.keys(a.B).forEach((s=>{try{r[s].triggers=[],function(e,t){if(void 0===t[e])throw new Error(`Command ${e} not found!`);switch(e){case o.n.ZOOM:case o.n.PAN:case o.n.FOCUS:i(e,t[e].triggers),n(e,t[e].smoothing);break;case o.n.TIME:i(e,t[e].triggers),n(e,t[e].interpolate);break;case o.n.SKIN:!function(e){const t=[];for(const r of e){const e=structuredClone(a.B[o.n.SKIN].TEMPLATE);for(const t of Object.keys(e))void 0!==r[t]&&(void 0!==r[t].fill&&(e[t].fill=r[t].fill),void 0!==r[t].stroke&&(e[t].stroke=r[t].stroke));t.push(e)}r[o.n.SKIN].triggers=t}(t[e].triggers);break;case o.n.GRAVITY:i(e,t[e].triggers)}}(s,e)}catch(e){e instanceof Error&&(console.warn(`[ScriptParser.parseScript()] ${e.message}`),r[s]=structuredClone(t[s]))}})),r}function g(e){var t;const r="#ffffffff",i=e.map((e=>{var t,i,n,a,o,s,l,c,g,d,h,m,f,p,u,E,_,S,b,v,y,M,T,k,I,O,C;return[` .outline {stroke: ${null!==(t=e.outline.stroke)&&void 0!==t?t:r}}`,` .skin {fill: ${null!==(i=e.skin.fill)&&void 0!==i?i:r}}`,` .hair {fill: ${null!==(n=e.hair.fill)&&void 0!==n?n:r}}`,` .fill {fill: ${null!==(a=e.fill.fill)&&void 0!==a?a:r}}`,` #eye {fill: ${null!==(o=e.eye.fill)&&void 0!==o?o:r}}`,` .sled {fill: ${null!==(s=e.sled.fill)&&void 0!==s?s:r}}`,` #string {stroke: ${null!==(l=e.string.stroke)&&void 0!==l?l:r}}`,` .arm .sleeve {fill: ${null!==(c=e.armSleeve.fill)&&void 0!==c?c:r}}`,` .arm .hand {fill: ${null!==(g=e.armHand.fill)&&void 0!==g?g:r}}`,` .leg .pants {fill: ${null!==(d=e.legPants.fill)&&void 0!==d?d:r}}`,` .leg .foot {fill: ${null!==(h=e.legFoot.fill)&&void 0!==h?h:r}}`,` .torso {fill: ${null!==(m=e.torso.fill)&&void 0!==m?m:r}}`,` .scarf1 {fill: ${null!==(f=e.scarf1.fill)&&void 0!==f?f:r}}`,` .scarf2 {fill: ${null!==(p=e.scarf2.fill)&&void 0!==p?p:r}}`,` .scarf3 {fill: ${null!==(u=e.scarf3.fill)&&void 0!==u?u:r}}`,` .scarf4 {fill: ${null!==(E=e.scarf4.fill)&&void 0!==E?E:r}}`,` .scarf5 {fill: ${null!==(_=e.scarf5.fill)&&void 0!==_?_:r}}`,` #scarf0 {fill: ${null!==(S=e.id_scarf0.fill)&&void 0!==S?S:r}}`,` #scarf1 {fill: ${null!==(b=e.id_scarf1.fill)&&void 0!==b?b:r}}`,` #scarf2 {fill: ${null!==(v=e.id_scarf2.fill)&&void 0!==v?v:r}}`,` #scarf3 {fill: ${null!==(y=e.id_scarf3.fill)&&void 0!==y?y:r}}`,` #scarf4 {fill: ${null!==(M=e.id_scarf4.fill)&&void 0!==M?M:r}}`,` #scarf5 {fill: ${null!==(T=e.id_scarf5.fill)&&void 0!==T?T:r}}`,` .hat .top {fill: ${null!==(k=e.hatTop.fill)&&void 0!==k?k:r}}`,` .hat .bottom {stroke: ${null!==(I=e.hatBottom.stroke)&&void 0!==I?I:r}}`,` .hat .ball {fill: ${null!==(O=e.hatBall.fill)&&void 0!==O?O:r}}`,` .flag {fill: ${null!==(C=e.flag.fill)&&void 0!==C?C:r}}`].join("").replace(/\n/g,"")}));return i.unshift(null!==(t=i.pop())&&void 0!==t?t:""),i}const d="CMD_EDITOR_MOD_",h={[e.FONT_SIZE]:r.MEDIUM,[e.VIEWPORT]:t.HD};function m(e){const t=window.localStorage.getItem(d+e);if(!t)return h[e];const r=parseInt(t,10);return isNaN(r)?h[e]:r}function f(e,t){window.localStorage.setItem(d+e,String(t))}function p(e){return e.simulator.engine}function u(e){return e.player.index}function E(e){return e.views.Sidebar}const{React:_}=window,S={style:{display:"block"},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},b=_.createElement("svg",Object.assign({},S),_.createElement("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),_.createElement("polyline",{points:"7 10 12 15 17 10"}),_.createElement("line",{x1:"12",y1:"15",x2:"12",y2:"3"})),v=_.createElement("svg",Object.assign({},S),_.createElement("polyline",{points:"15 14 20 9 15 4"}),_.createElement("path",{d:"M4 20v-7a4 4 0 0 1 4-4h12"})),y=_.createElement("svg",Object.assign({},S),_.createElement("polygon",{points:"5 3 19 12 5 21 5 3"})),M=_.createElement("svg",Object.assign({},S),_.createElement("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),_.createElement("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})),T=_.createElement("svg",Object.assign({},S),_.createElement("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),_.createElement("polyline",{points:"17 8 12 3 7 8"}),_.createElement("line",{x1:"12",y1:"3",x2:"12",y2:"15"})),k=_.createElement("svg",Object.assign({},S),_.createElement("circle",{cx:"12",cy:"12",r:"3"}),_.createElement("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})),I=_.createElement("svg",Object.assign({},S),_.createElement("circle",{cx:"12",cy:"12",r:"10"}),_.createElement("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),_.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})),O=_.createElement("svg",Object.assign({},S),_.createElement("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})),C=_.createElement("svg",Object.assign({},S),_.createElement("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})),D=_.createElement("svg",Object.assign({},S),_.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),_.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"})),w=(_.createElement("svg",Object.assign({},S),_.createElement("circle",{cx:"12",cy:"12",r:"10"}),_.createElement("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),_.createElement("line",{x1:"8",y1:"12",x2:"16",y2:"12"})),_.createElement("svg",Object.assign({},S),_.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))),x=_.createElement("svg",Object.assign({},S),_.createElement("polyline",{points:"3 6 5 6 21 6"}),_.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),_.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),_.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"})),A=_.createElement("svg",Object.assign({},S),_.createElement("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),_.createElement("polyline",{points:"12 19 5 12 12 5"})),P=_.createElement("svg",Object.assign({},S),_.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),_.createElement("polyline",{points:"12 5 19 12 12 19"})),N=_.createElement("svg",Object.assign({},S),_.createElement("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),_.createElement("circle",{cx:"12",cy:"13",r:"4"})),{React:R}=window;function L(e,t,r,i,n){const a=Number(t);return Number.isNaN(a)?e:r?Math.max(i,Math.min(n,a)):t.includes(".")||"-"===t||""===t?t:a}function U({style:e,id:t,value:r,min:i,max:n,onChange:a}){return R.createElement("input",{style:e,id:t,value:r,min:i,max:n,onChange:e=>a(L(r,e.target.value,!1,i,n)),onBlur:e=>a(L(r,e.target.value,!0,i,n))})}const{React:F}=window;function j(e,t,r,i,n){const a=Number(t);return Number.isNaN(a)||!Number.isInteger(a)?e:r?Math.max(i,Math.min(n,a)):"-"===t||""===t?t:a}function z({style:e,id:t,value:r,min:i,max:n,onChange:a}){return F.createElement("input",{style:e,id:t,value:r,min:i,max:n,onChange:e=>a(j(r,e.target.value,!1,i,n)),onBlur:e=>a(j(r,e.target.value,!0,i,n))})}const{React:H}=window;function B({current:e,target:t,label:r,onClick:n}){return H.createElement("button",{style:{border:"2px solid black",borderRadius:"5px",margin:"5px",backgroundColor:e===t?i.light_gray1:i.dark_gray1},onClick:()=>n(t)},H.createElement("text",null,r))}const{React:K}=window;var V;!function(e){e[e.BLURRED=0]="BLURRED",e[e.HOVER=1]="HOVER",e[e.PRESSED=2]="PRESSED"}(V||(V={}));const Z={alignItems:"center",background:"none",borderRadius:"0.5em",border:"none",display:"flex",fontSize:"22px",height:"1.5em",justifyContent:"center",userSelect:"none",width:"1.5em"},W={[V.BLURRED]:"transparent",[V.HOVER]:i.dark_gray1,[V.PRESSED]:i.light_gray1};class G extends K.Component{constructor(e){super(e),this.state={mode:V.BLURRED}}render(){const{title:e,disabled:t,onClick:r,icon:n}=this.props;return t&&this.state.mode!==V.BLURRED&&this.setState({mode:V.BLURRED}),K.createElement("button",{title:e,style:Object.assign(Object.assign(Object.assign({},Z),this.props.style),{backgroundColor:W[this.state.mode]}),onMouseOver:()=>!t&&this.setState({mode:V.HOVER}),onMouseOut:()=>!t&&this.setState({mode:V.BLURRED}),onMouseDown:()=>!t&&this.setState({mode:V.PRESSED}),onMouseUp:()=>!t&&this.setState({mode:V.HOVER}),onClick:r,disabled:t},K.createElement("span",{style:{color:t?i.gray:i.black}},n))}}const{React:$}=window;class Y{constructor(e){this.root=e}main(){const e=this.root.state;return $.createElement("div",{style:i.text},this.toolbar(),e.active&&$.createElement("div",{style:n.content},e.settingsActive&&this.settingsContainer(),!e.settingsActive&&this.tabContainer(),!e.settingsActive&&this.window()))}toolbar(){const e=this.root,t=this.root.state;return $.createElement("div",{style:n.toolbar.container},!t.active&&$.createElement(G,{title:"Maximize",onClick:()=>e.onToggleActive(),icon:C}),t.active&&$.createElement("div",{style:Object.assign(Object.assign({},n.toolbar.container),{justifyContent:"start"})},$.createElement(G,{title:"Minimize",onClick:()=>e.onToggleActive(),icon:O}),$.createElement(G,{title:"Download",onClick:()=>e.onDownload(),icon:b}),$.createElement(G,{title:"Upload",onClick:()=>e.onUpload(),icon:T}),$.createElement(G,{title:"Load From Script",onClick:()=>e.onLoadScript(),icon:v}),$.createElement(G,{title:"Run",onClick:()=>e.onTest(),icon:y,disabled:t.invalidTimes.some((e=>e))}),$.createElement(G,{title:"Copy Script",onClick:()=>{return t=this,r=void 0,n=function*(){return yield e.onCopy()},new((i=void 0)||(i=Promise))((function(e,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(o,s)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n},icon:M})),t.active&&$.createElement("div",{style:Object.assign(Object.assign({},n.toolbar.container),{justifyContent:"end"})},$.createElement(G,{title:"Undo",onClick:()=>e.onUndo(),icon:A,disabled:0===e.triggerManager.undoLen}),$.createElement(G,{title:"Redo",onClick:()=>e.onRedo(),icon:P,disabled:0===e.triggerManager.redoLen}),$.createElement(G,{title:"Settings",onClick:()=>e.onToggleSettings(),icon:k}),$.createElement(G,{title:"Help",onClick:()=>e.onHelp(),icon:I})),$.createElement("input",{id:"trigger-file-upload",style:{display:"none"},type:"file",accept:".json",onChange:t=>e.onLoadFile(t.target.files[0])}))}settingsContainer(){return $.createElement("div",{style:n.settings.window},this.settingsHeader(),this.settings())}settingsHeader(){const e=this.root,t=this.root.state;return $.createElement("div",{style:n.settings.header},$.createElement(G,{onClick:()=>e.onToggleSettings(),icon:w,style:{position:"absolute",right:"0px"}}),$.createElement("text",{style:{fontSize:i.textSizes.L[t.fontSize]}},"Settings"),$.createElement("button",{style:{fontSize:i.textSizes.M[t.fontSize],position:"absolute",left:"0px",background:t.settingsDirty?i.light_gray3:i.dark_gray1},disabled:!t.settingsDirty,onClick:()=>e.onApplySettings()},"Apply"))}settings(){const e=this.root,a=this.root.state;return $.createElement("div",{style:{fontSize:i.textSizes.M[a.fontSize]}},$.createElement("div",{style:n.settings.row},$.createElement("text",{style:Object.assign(Object.assign({},n.settings.label),{fontSize:i.textSizes.S[a.fontSize]})},"Font Sizes"),$.createElement("div",{style:Object.assign(Object.assign({},n.settings.parameter),{fontSize:i.textSizes.S[a.fontSize]})},$.createElement(B,{current:a.fontSizeSetting,target:r.SMALL,label:"Small",onClick:t=>e.onChangeFontSize(t)}),$.createElement(B,{current:a.fontSizeSetting,target:r.MEDIUM,label:"Medium",onClick:t=>e.onChangeFontSize(t)}),$.createElement(B,{current:a.fontSizeSetting,target:r.LARGE,label:"Large",onClick:t=>e.onChangeFontSize(t)}))),$.createElement("div",{style:n.settings.row},$.createElement("text",{style:Object.assign(Object.assign({},n.settings.label),{fontSize:i.textSizes.S[a.fontSize]})},"Viewport"),$.createElement("div",{style:Object.assign(Object.assign({},n.settings.parameter),{fontSize:i.textSizes.S[a.fontSize]})},$.createElement(B,{current:a.fontSizeSetting,target:t.HD,label:"720p",onClick:t=>e.onChangeViewport(t)}),$.createElement(B,{current:a.fontSizeSetting,target:t.FHD,label:"1080p",onClick:t=>e.onChangeViewport(t)}),$.createElement(B,{current:a.fontSizeSetting,target:t.QHD,label:"1440p",onClick:t=>e.onChangeViewport(t)}),$.createElement(B,{current:a.fontSizeSetting,target:t.UHD,label:"4K",onClick:t=>e.onChangeViewport(t)}))))}tabContainer(){const e=this.root,t=this.root.state;return $.createElement("div",{style:n.tabs.container},...Object.keys(a.B).map((r=>$.createElement("div",null,$.createElement("button",{style:Object.assign(Object.assign({},n.tabs.button),{backgroundColor:t.activeTab===r?i.light_gray1:i.dark_gray1}),onClick:()=>e.onChangeTab(r)},$.createElement("text",{style:{fontSize:i.textSizes.S[t.fontSize]}},a.B[r].DISPLAY_NAME))))))}window(){const e=this.root,t=this.root.state,r=e.triggerManager.data[t.activeTab];return r.id===o.n.SKIN?$.createElement("div",{style:n.window},this.skinEditorToolbar(t.skinEditorSelectedRider),this.skinEditor(r.triggers)):$.createElement("div",{style:n.window},r.id!==o.n.GRAVITY&&this.smoothTab(),Object.keys(r.triggers).map((e=>this.trigger(parseInt(e,10)))))}smoothTab(){const e=this.root,t=this.root.state,r=e.triggerManager.data[t.activeTab];return $.createElement("div",{style:n.smooth.container},$.createElement("label",{htmlFor:"smoothTextInput",style:{fontSize:i.textSizes.S[t.fontSize]}},"Smoothing"),r.id!==o.n.TIME?$.createElement(z,{id:"smoothTextInput",style:Object.assign(Object.assign({},n.smooth.input),{fontSize:i.textSizes.S[t.fontSize]}),value:r.smoothing||0,min:l.v.SMOOTH.MIN,max:l.v.SMOOTH.MAX,onChange:t=>e.onUpdateTrigger(t,["smoothing"])}):$.createElement("div",{style:n.checkbox.container},$.createElement("input",{id:"smoothTextInput",style:n.checkbox.primary,type:"checkbox",onChange:()=>e.onUpdateTrigger(!e.triggerManager.data[t.activeTab].interpolate,["interpolate"])}),r.interpolate&&$.createElement("div",{style:n.checkbox.fill})))}trigger(e){const t=this.root,r=this.root.state,a=t.triggerManager.data[r.activeTab],s=a.triggers[e];return $.createElement("div",{style:Object.assign(Object.assign({},n.trigger.container),{fontSize:i.textSizes.M[r.fontSize],backgroundColor:i.white})},$.createElement("div",{style:n.trigger.buttonContainer},$.createElement(G,{onClick:()=>t.onDeleteTrigger(e),icon:w,disabled:0===e}),a.id===o.n.ZOOM||a.id===o.n.PAN&&$.createElement(G,{onClick:()=>t.onCaptureCamera(e,a.id),icon:N})),this.timeStamp(s[0],e),a.id===o.n.ZOOM&&this.zoomTrigger(s,e),a.id===o.n.PAN&&this.cameraPanTrigger(s,e),a.id===o.n.FOCUS&&this.cameraFocusTrigger(s,e),a.id===o.n.TIME&&this.timeRemapTrigger(s,e),a.id===o.n.GRAVITY&&this.gravityTrigger(s,e),$.createElement("button",{style:n.trigger.createButton,onClick:()=>t.onCreateTrigger(e)},$.createElement("span",null,D)))}timeStamp(e,t){const r=this.root.state,i=[l.v.MINUTE,l.v.SECOND,l.v.FRAME],a=["Time",":",":"];return $.createElement("div",{style:n.trigger.property},...e.map(((e,n)=>$.createElement("div",null,this.triggerProp(a[n],e,["triggers",t.toString(),"0",n.toString()],i[n],r.invalidTimes[t]?"red":"black",!0)))))}zoomTrigger(e,t){return $.createElement("div",{style:n.trigger.property},this.triggerProp("Zoom To",e[1],["triggers",t.toString(),"1"],l.v.ZOOM))}cameraPanTrigger(e,t){const r=[l.v.PAN_WIDTH,l.v.PAN_HEIGHT,l.v.PAN_X,l.v.PAN_Y],i=["Width","Height","Offset X","Y"];return $.createElement("div",null,...[["w","h"],["x","y"]].map(((a,o)=>$.createElement("div",{style:{display:"flex",flexDirection:"row"}},...a.map(((a,s)=>$.createElement("div",{style:n.trigger.property},this.triggerProp(i[s+2*o],e[1][a],["triggers",t.toString(),"1",a],r[s+2*o]))))))))}cameraFocusTrigger(e,t){const r=this.root,i=this.root.state.focusDDIndices[t];return $.createElement("div",{style:n.trigger.property},$.createElement("select",{style:n.dropdown.head,value:i,onChange:e=>r.onChangeFocusDD(t,e.target.value)},...Object.keys(e[1]).map((e=>$.createElement("option",{style:n.dropdown.option,value:parseInt(e,10)},$.createElement("text",null,"Rider ",1+parseInt(e,10)))))),this.triggerProp("Weight",e[1][i],["triggers",t.toString(),"1",i.toString()],l.v.FOCUS_WEIGHT))}timeRemapTrigger(e,t){return $.createElement("div",{style:n.trigger.property},this.triggerProp("Speed",e[1],["triggers",t.toString(),"1"],l.v.TIME_SPEED))}gravityTrigger(e,t){const r=this.root,i=this.root.state.gravityDDIndices[t],a=[l.v.GRAVITY_X,l.v.GRAVITY_Y],o=["X","Y"];return $.createElement("div",{style:{display:"flex",flexDirection:"row"}},$.createElement("select",{style:n.dropdown.head,value:i,onChange:e=>r.onChangeGravityDD(t,e.target.value)},...Object.keys(e[1]).map((e=>$.createElement("option",{style:n.dropdown.option,value:parseInt(e,10)},$.createElement("text",null,"Rider ",1+parseInt(e,10)))))),...["x","y"].map(((r,s)=>$.createElement("div",{style:n.trigger.property},this.triggerProp(o[s],e[1][i][r],["triggers",t.toString(),"1",i.toString(),r],a[s])))))}triggerProp(e,t,r,i,a,o=!1){const s=this.root,l=o?z:U;return $.createElement("div",null,$.createElement("label",{style:n.trigger.text,htmlFor:r.join("_")},e),$.createElement(l,{style:Object.assign(Object.assign({},n.trigger.input),{color:a||"black"}),id:r.join("_"),value:t,min:i.MIN,max:i.MAX,onChange:e=>s.onUpdateTrigger(e,r)}))}skinEditor(e){const t=this.root,r=this.root.state,a=r.skinEditorSelectedRider;return $.createElement("div",{style:n.skinEditor.container},$.createElement("div",{style:n.skinEditor.background}),$.createElement("div",{id:"skinElementContainer",style:Object.assign(Object.assign({},n.skinEditor.canvas),{transform:`scale(${r.skinEditorZoom[0]})`,transformOrigin:`${r.skinEditorZoom[1]}px ${r.skinEditorZoom[2]}px`}),onWheel:e=>t.onZoomSkinEditor(e,!0)},this.flagSvg(e[a],a.toString()),$.createElement("svg",{width:"10vw"}),this.riderSvg(e[a],a.toString())),$.createElement("div",{style:n.skinEditor.zoomContainer},$.createElement("input",{style:{height:"10px"},type:"range",min:l.v.SKIN_ZOOM.MIN,max:l.v.SKIN_ZOOM.MAX,step:.1,value:r.skinEditorZoom[0],onChange:e=>t.onZoomSkinEditor(e,!1)}),$.createElement("text",{style:{fontSize:i.textSizes.S[r.fontSize]}},"x",Math.round(10*r.skinEditorZoom[0])/10)),$.createElement("div",{style:n.skinEditor.outlineColor.container},$.createElement("text",{style:{fontSize:i.textSizes.S[r.fontSize]}},"Outline"),$.createElement("div",{style:Object.assign(Object.assign({},n.skinEditor.outlineColor.input),{backgroundColor:e[a].outline.stroke}),onClick:()=>t.onUpdateTrigger(r.skinEditorSelectedColor,["triggers",a.toString(),"outline","stroke"])})))}skinEditorToolbar(e){const t=this.root,r=this.root.state,a=t.triggerManager.data[o.n.SKIN].triggers,s=r.skinEditorSelectedColor.substring(0,7),c=parseInt(r.skinEditorSelectedColor.substring(7),16)/255;return $.createElement("div",{style:n.skinEditor.toolbar},$.createElement(G,{onClick:()=>t.onResetSkin(e),icon:x,style:{position:"absolute",right:"10px"}}),$.createElement("div",{style:Object.assign(Object.assign(Object.assign({},n.skinEditor.toolbarItem),n.alpha.container),{fontSize:i.textSizes.S[r.fontSize]})},$.createElement("label",{htmlFor:"alphaSlider"},"Transparency"),$.createElement("div",{style:n.alpha.sliderContainer},$.createElement("input",{id:"alphaSlider",style:n.alpha.slider,type:"range",min:l.v.ALPHA_SLIDER.MIN,max:l.v.ALPHA_SLIDER.MAX,step:.01,value:c,onChange:e=>t.onChangeColor(void 0,e.target.value)}))),$.createElement("input",{style:Object.assign(Object.assign({},n.skinEditor.toolbarItem),{height:"40px",width:"40px"}),type:"color",value:s,onChange:e=>t.onChangeColor(e.target.value,void 0)}),$.createElement("select",{style:Object.assign(Object.assign(Object.assign({},n.skinEditor.toolbarItem),n.dropdown.head),{fontSize:i.textSizes.M[r.fontSize]}),value:e,onChange:e=>t.onChangeSkinDD(e.target.value)},...Object.keys(a).map((e=>$.createElement("option",{style:n.dropdown.option,value:parseInt(e,10)},"Rider ",1+parseInt(e,10))))))}flagSvg(e,t){const r=this.root,i=this.root.state,n=(e,n=!1)=>{r.onUpdateTrigger(i.skinEditorSelectedColor,["triggers",t,e,n?"stroke":"fill"])};return $.createElement("svg",{height:"18",width:"15",style:{transform:"scale(5)"}},$.createElement("path",{transform:"translate(-5, -3)",d:"M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3Z",fill:e.flag.fill,onClick:()=>n("flag")}),$.createElement("path",{transform:"translate(-5, -3)",d:"M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3M7,7.25V11.5C7,11.5 9,10 11,10C13,10 14,12 16,12C18,12 18,11 18,11V7.5C18,7.5 17,8 16,8C14,8 13,6 11,6C9,6 7,7.25 7,7.25Z",fill:e.flag.fill,onClick:()=>n("flag")}))}riderSvg(e,t){const r=this.root,i=this.root.state,a=(e,n=!1)=>{r.onUpdateTrigger(i.skinEditorSelectedColor,["triggers",t,e,n?"stroke":"fill"])};return $.createElement("svg",{height:"25",width:"31",style:{transform:"scale(5)"}},$.createElement("rect",{transform:"translate(13,8) rotate(-90)",width:"3.1",height:"4.5",fill:e.skin.fill,onClick:()=>a("skin")}),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(17.3,8.1) rotate(-90)",d:"M 0 -0.25 v 0.4 c 0.1 1.3 1.2 1.2 3.1 0 v -0.4",stroke:e.outline.stroke,fill:e.skin.fill,onClick:()=>a("skin")})),$.createElement("rect",{transform:"translate(12.4, 5.15) rotate(-90)",width:"0.3",height:"5.1",fill:e.hair.fill,onClick:()=>a("hair")}),$.createElement("rect",{transform:"translate(12.2, 8.1) rotate(-90)",width:"3.1",height:"0.3",fill:e.hair.fill,onClick:()=>a("hair")}),$.createElement("rect",{transform:"translate(12.2,4.2) scale(0.8,0.8)",width:"3.1",height:"4.8",fill:e.fill.fill,onClick:()=>a("fill")}),$.createElement("polygon",{transform:"translate(16.3,6.7)",points:"0.4,-0.4 0,-0.5 -0.4,-0.4 -0.5,0 -0.4,0.4 0,0.5 0.4,0.4 0.5,0",fill:e.eye.fill,onClick:()=>a("eye")}),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(9.7, 15.9) scale(1.04,1)",d:"M13.6-2.2c-1.35,0-2.55,0.75-3.15,1.85H0C-0.2-0.35-0.35-0.2-0.35,0S-0.2,0.35,0,0.35h1.75V4.4H-0.2c-0.2,0-0.35,0.15-0.35,0.35S-0.4,5.1-0.2,5.1h13.8c2,0,3.65-1.65,3.65-3.65S15.6-2.2,13.6-2.2zM9.05,4.4h-6.6V0.35h6.6V4.4z M13.6,4.4H9.75V0.35h0.35C10.05,0.5,10,0.7,10,0.9c0,0.2,0.15,0.35,0.35,0.35c0.15,0,0.3-0.1,0.35-0.25c0.05-0.2,0.1-0.45,0.2-0.65h0.9c0.2,0,0.35-0.15,0.35-0.35S12-0.35,11.8-0.35h-0.5c0.5-0.7,1.35-1.15,2.3-1.15c1.65,0,2.95,1.3,2.95,2.95C16.55,3.1,15.25,4.4,13.6,4.4z",stroke:e.outline.stroke,fill:e.sled.fill,onClick:()=>a("sled")})),$.createElement("line",{transform:"translate(21.5, 10.5) rotate(40)",x1:"0",y1:"0",x2:"8",y2:"0",strokeWidth:"0.3",stroke:e.string.stroke,onClick:()=>a("string",!0)}),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(15, 10) rotate(5)",d:"M5-0.7h0.5c0,0,0.3-0.7,0.5-0.6c0.2,0.1,0,0.6,0,0.6s0.4,0,0.6,0c0.2,0,0.5,0.3,0.5,0.7c0,0.4-0.2,0.7-0.5,0.7c-0.5,0-1.6,0-1.6,0",stroke:e.outline.stroke,fill:e.armHand.fill,onClick:()=>a("armHand")})),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(15, 16) rotate(45)",d:"M4.8-0.7H0c-0.4,0-0.7,0.3-0.7,0.7S-0.4,0.7,0,0.7h4.8",stroke:e.outline.stroke,fill:e.legPants.fill,onClick:()=>a("legPants")})),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(15, 16) rotate(45)",d:"M4.8,0.7h2.4l0-2.7L6.7-2L6-0.7H4.8",stroke:e.outline.stroke,fill:e.legFoot.fill,onClick:()=>a("legFoot")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfEven,{x:"2",fill:e.id_scarf0.fill,onClick:()=>a("id_scarf0")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfEven,{x:"0",fill:e.id_scarf0.fill,onClick:()=>a("id_scarf0")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfOdd,{x:"-2",fill:e.id_scarf1.fill,onClick:()=>a("id_scarf1")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfOdd,{x:"-4",fill:e.id_scarf2.fill,onClick:()=>a("id_scarf2")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfOdd,{x:"-6",fill:e.id_scarf3.fill,onClick:()=>a("id_scarf3")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfOdd,{x:"-8",fill:e.id_scarf4.fill,onClick:()=>a("id_scarf4")})),$.createElement("rect",Object.assign({},n.riderProps.id_scarfOdd,{x:"-10",fill:e.id_scarf5.fill,onClick:()=>a("id_scarf5")})),$.createElement("rect",Object.assign({},n.riderProps.outline,{transform:"translate(16.9, 8.1) rotate(90)",width:"7.8",height:"4.4",stroke:e.outline.stroke,fill:e.torso.fill,onClick:()=>a("torso")})),$.createElement("rect",Object.assign({},n.riderProps.scarfOdd,{y:"1.5",fill:e.scarf1.fill,onClick:()=>a("scarf1")})),$.createElement("rect",Object.assign({},n.riderProps.scarfOdd,{y:"0.5",fill:e.scarf2.fill,onClick:()=>a("scarf2")})),$.createElement("rect",Object.assign({},n.riderProps.scarfOdd,{y:"-0.5",fill:e.scarf3.fill,onClick:()=>a("scarf3")})),$.createElement("rect",Object.assign({},n.riderProps.scarfOdd,{y:"-1.5",fill:e.scarf4.fill,onClick:()=>a("scarf4")})),$.createElement("rect",Object.assign({},n.riderProps.scarfOdd,{y:"-2.5",fill:e.scarf5.fill,onClick:()=>a("scarf5")})),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",d:"M11-2.6h-0.4v5.2H11c1.2,0,2.2-1.2,2.2-2.6S12.2-2.6,11-2.6z",stroke:e.outline.stroke,fill:e.hatTop.fill,onClick:()=>a("hatTop")})),$.createElement("path",{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",strokeWidth:"1",strokeLinecap:"round",d:"M10.6-2.6 v5.2",stroke:e.hatBottom.stroke,onClick:()=>a("hatBottom",!0)}),$.createElement("circle",{transform:"translate(14.8,5) rotate(-90) translate(-10,0)",cx:"13.9",cy:"0",r:"0.7",fill:e.hatBall.fill,onClick:()=>a("hatBall")}),$.createElement("path",Object.assign({},n.riderProps.outline,{transform:"translate(15, 10) rotate(5)",d:"M5,0.7H0c-0.4,0-0.7-0.3-0.7-0.7S-0.4-0.7,0-0.7h5",stroke:e.outline.stroke,fill:e.armSleeve.fill,onClick:()=>a("armSleeve")})))}}const{store:X,React:q}=window;class J extends q.Component{constructor(t){super(t),this.componentManager=new Y(this),this.triggerManager=new a.G,this.state={active:!1,activeTab:o.n.ZOOM,triggerUpdateFlag:!1,focusDDIndices:[0],gravityDDIndices:[0],skinEditorSelectedRider:0,skinEditorSelectedColor:"#000000ff",skinEditorZoom:[1,0,0],settingsActive:!1,settingsDirty:!1,fontSize:m(e.FONT_SIZE),resolution:m(e.VIEWPORT),fontSizeSetting:m(e.FONT_SIZE),resolutionSetting:m(e.VIEWPORT),invalidTimes:[]},X.subscribe((()=>this.updateStore()))}componentDidMount(){window.saveCommands=()=>this.onDownload()}updateStore(){const e=p(X.getState()).engine.state.riders.length;if(this.lastRiderCount!==e){this.lastRiderCount=e;const{skinEditorSelectedRider:t,focusDDIndices:r,gravityDDIndices:i}=this.state;t>=e&&this.setState({skinEditorSelectedRider:e-1}),this.triggerManager.updateRiderCount(e),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag}),this.setState({focusDDIndices:r.map((t=>Math.min(e-1,t)))}),this.setState({gravityDDIndices:i.map((t=>Math.min(e-1,t)))})}E(X.getState())&&this.setState({active:!1})}onCreateTrigger(e){const{activeTab:t,focusDDIndices:r,gravityDDIndices:i}=this.state;if(t===o.n.SKIN)return;const n=u(X.getState()),a=[Math.floor(n/2400),Math.floor(n%2400/40),Math.floor(n%40)],s=this.triggerManager.data[t].triggers,c=[a,structuredClone(s[e][1])],g=s.slice(0,e+1).concat([c]).concat(s.slice(e+1));this.triggerManager.updateFromPath([t,"triggers"],g,t),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag});const d=this.triggerManager.data[t].triggers;t===o.n.FOCUS&&this.setState({focusDDIndices:r.slice(0,e+1).concat([0]).concat(r.slice(e+1))}),t===o.n.GRAVITY&&this.setState({gravityDDIndices:i.slice(0,e+1).concat([0]).concat(i.slice(e+1))}),this.setState({invalidTimes:(0,l.P)(d)})}onUpdateTrigger(e,t){const{activeTab:r}=this.state;this.triggerManager.updateFromPath([r,...t],e,r),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag});const i=this.triggerManager.data[r].triggers;r!==o.n.SKIN&&this.setState({invalidTimes:(0,l.P)(i)})}onDeleteTrigger(e){const{activeTab:t,focusDDIndices:r,gravityDDIndices:i}=this.state;if(t===o.n.SKIN)return;const n=this.triggerManager.data[t].triggers,a=n.slice(0,e).concat(n.slice(e+1));this.triggerManager.updateFromPath([t,"triggers"],a,t),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag});const s=this.triggerManager.data[t].triggers;t===o.n.FOCUS&&this.setState({focusDDIndices:r.slice(0,e).concat(r.slice(e+1))}),t===o.n.FOCUS&&this.setState({gravityDDIndices:i.slice(0,e).concat(i.slice(e+1))}),this.setState({invalidTimes:(0,l.P)(s)})}onDownload(){const e=JSON.stringify(this.triggerManager.data),t=document.createElement("a"),r="data:text/json;charset=utf-8,"+encodeURIComponent(e);t.setAttribute("href",r),t.setAttribute("download",X.getState().trackData.label+".script.json"),t.click(),t.remove()}onUpload(){const e=document.getElementById("trigger-file-upload");e.value="",e.click()}onLoadFile(e){const t=new window.FileReader;t.onload=()=>{try{this.onLoad(c(JSON.parse(t.result),this.triggerManager.data))}catch(e){e instanceof Error&&console.error(`[Root.onLoadFile()] Failed to load file: ${e.message}`)}},t.readAsText(e)}onLoadScript(){this.onLoad((0,s.A)(X.getState().trackData.script,this.triggerManager.data))}onLoad(e){const{activeTab:t}=this.state;try{const r=e[o.n.FOCUS].triggers,i=Array(r.length).fill(0),n=e[o.n.GRAVITY].triggers,a=Array(n.length).fill(0);if(this.triggerManager.updateFromPath([],e,o.n.ZOOM),t!==o.n.SKIN){const r=e[t].triggers;this.setState({invalidTimes:(0,l.P)(r)})}this.setState({focusDDIndices:i}),this.setState({gravityDDIndices:a}),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag})}catch(e){e instanceof Error&&console.error(`[Root.onLoad()] ${e.message}`)}}onTest(){const{activeTab:e,invalidTimes:t}=this.state;try{if(!t.every((e=>!e)))throw new Error("Triggers contain invalid times!");const r=this.triggerManager.data[e];switch(e){case o.n.ZOOM:window.getAutoZoom=window.createZoomer(r.triggers,r.smoothing);break;case o.n.PAN:window.getCamBounds=window.createBoundsPanner(r.triggers,r.smoothing);break;case o.n.FOCUS:window.getCamFocus=window.createFocuser(r.triggers,r.smoothing);break;case o.n.TIME:window.timeRemapper=window.createTimeRemapper(r.triggers,r.interpolate);break;case o.n.SKIN:window.setCustomRiders(g(r.triggers));break;case o.n.GRAVITY:void 0!==window.setCustomGravity&&window.setCustomGravity(r.triggers)}}catch(e){e instanceof Error&&console.error(`[Root.onTest()] ${e.message}`)}}onCopy(){return e=this,t=void 0,i=function*(){const{activeTab:e,invalidTimes:t}=this.state;try{if(!t.every((e=>!e)))throw new Error("Triggers contain invalid times!");const r=function(e,t){const r=t[e],i=a.B[e].FUNC;if(void 0===i)return"";switch(e){case o.n.FOCUS:case o.n.PAN:case o.n.ZOOM:return i.replace("{0}",JSON.stringify(r.triggers)).replace("{1}",String(r.smoothing)).replace(" ","");case o.n.TIME:return i.replace("{0}",JSON.stringify(r.triggers)).replace("{1}",String(r.interpolate)).replace(" ","");case o.n.SKIN:return i.replace("{0}",JSON.stringify(g(r.triggers))).replace(" ","");default:return""}}(e,this.triggerManager.data);return yield navigator.clipboard.writeText(r)}catch(e){e instanceof Error&&console.error(`[Root.onCopy()] ${e.message}`)}},new((r=void 0)||(r=Promise))((function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}));var e,t,r,i}onUndo(){const{activeTab:e}=this.state,t=this.triggerManager.undo();if(this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag}),e!==t&&this.setState({activeTab:t}),e!==o.n.SKIN){const t=this.triggerManager.data[e].triggers;this.setState({invalidTimes:(0,l.P)(t)})}}onRedo(){const{activeTab:e}=this.state,t=this.triggerManager.redo();if(this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag}),e!==t&&this.setState({activeTab:t}),e!==o.n.SKIN){const t=this.triggerManager.data[e].triggers;this.setState({invalidTimes:(0,l.P)(t)})}}onResetSkin(e){this.triggerManager.updateFromPath([o.n.SKIN,"triggers",e.toString()],structuredClone(a.B[o.n.SKIN].TEMPLATE),o.n.SKIN),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag})}onChangeColor(e,t){const{skinEditorSelectedColor:r}=this.state,i=null!=t?Math.round(255*Math.min(Math.max(parseFloat(t),0),1)).toString(16).padStart(2,"0"):r.substring(7),n=null!=e?e+i:r.substring(0,7)+i;this.setState({skinEditorSelectedColor:n})}onToggleActive(){const{active:e}=this.state,t=E(X.getState());!e&&t&&X.dispatch({type:"SET_VIEWS",payload:{Sidebar:null},meta:{name:"SET_SIDEBAR_PAGE",auto:!1}}),this.setState({active:!e})}onChangeTab(e){if(this.setState({activeTab:e}),e!==o.n.SKIN){const t=this.triggerManager.data[e].triggers;this.setState({invalidTimes:(0,l.P)(t)})}}onToggleSettings(){const{settingsActive:e,settingsDirty:t,fontSize:r,resolution:i}=this.state;e&&t&&(this.setState({fontSizeSetting:r}),this.setState({resolutionSetting:i}),this.setState({settingsDirty:!1})),this.setState({settingsActive:!e})}onHelp(){window.open("https://github.com/Malizma333/line-rider-command-editor-userscript#readme")}onChangeFontSize(e){const{fontSize:t}=this.state;e!==t&&this.setState({settingsDirty:!0}),this.setState({fontSizeSetting:e})}onChangeViewport(e){const{resolution:t}=this.state;t!==e&&this.setState({settingsDirty:!0}),this.setState({resolutionSetting:e})}onApplySettings(){const{resolutionSetting:r,resolution:i,fontSizeSetting:n}=this.state,a={[t.HD]:{width:1280,height:720},[t.FHD]:{width:1920,height:1080},[t.QHD]:{width:2560,height:1440},[t.UHD]:{width:3840,height:2160}},s=Math.log2(a[r].width/a[i].width);X.dispatch({type:"SET_PLAYBACK_DIMENSIONS",payload:a[r]});const l=this.triggerManager.data[o.n.ZOOM].triggers.map((e=>[e[0],Math.round(1e7*(e[1]+s+Number.EPSILON))/1e7]));this.triggerManager.updateFromPath([o.n.ZOOM,"triggers"],l,o.n.ZOOM),this.setState({triggerUpdateFlag:!this.state.triggerUpdateFlag}),f(e.FONT_SIZE,n),f(e.VIEWPORT,r),this.setState({settingsDirty:!1}),this.setState({fontSize:n}),this.setState({resolution:r})}onChangeFocusDD(e,t){const{focusDDIndices:r}=this.state,i=[...r];i[e]=parseInt(t,10),this.setState({focusDDIndices:i})}onChangeGravityDD(e,t){const{gravityDDIndices:r}=this.state,i=[...r];i[e]=parseInt(t,10),this.setState({gravityDDIndices:i})}onChangeSkinDD(e){this.setState({skinEditorSelectedRider:parseInt(e,10)})}onZoomSkinEditor(e,t){const{skinEditorZoom:r}=this.state,i=document.getElementById("skinElementContainer").getBoundingClientRect(),[n,a,o]=r;let s=n,c=a,g=o;if(t){const t=e;n<l.v.SKIN_ZOOM.MAX&&(c=(t.clientX-i.x)/n,g=(t.clientY-i.y)/n),s=Math.max(Math.min(n-.001*t.deltaY,l.v.SKIN_ZOOM.MAX),l.v.SKIN_ZOOM.MIN)}else s=Math.max(Math.min(parseInt(e.target.value),l.v.SKIN_ZOOM.MAX),l.v.SKIN_ZOOM.MIN);this.setState({skinEditorZoom:[s,c,g]})}onCaptureCamera(e,t){switch(t){case o.n.ZOOM:this.onUpdateTrigger(Math.log2(X.getState().camera.editorZoom),["triggers",e.toString(),"1"]);break;case o.n.PAN:{const{x:t,y:r}=X.getState().camera.editorPosition,i=p(X.getState()),{width:n,height:a}=function(e){return e.camera.playbackDimensions||e.camera.editorDimensions}(X.getState()),o=function(e){return window.getAutoZoom?window.getAutoZoom(u(e)):e.camera.playbackZoom}(X.getState()),s=Math.floor(u(X.getState())),l=X.getState().camera.playbackFollower.getCamera(i,{zoom:o,width:n,height:a},s);this.onUpdateTrigger((t-l.x)*o/n,["triggers",e.toString(),"1","x"]),this.onUpdateTrigger((r-l.y)*o/a,["triggers",e.toString(),"1","y"]);break}}}render(){return this.componentManager.main()}}function Q(){const{React:e,store:t}=window,r=document.getElementById("content"),i=document.createElement("div");Object.assign(i.style,n.root),window.ReactDOM.render(e.createElement(J),i),r.appendChild(i),t.subscribe((()=>{const e=t.getState().player.running,r=t.getState().views.Main,n=window.CMD_EDITOR_DEBUG||!e&&r;i.style.opacity=n?"1":"0",i.style.pointerEvents=n?"auto":"none"}));const a=setInterval((()=>{const e=r.querySelector('div[style="margin: 16px;"]');if(e){const t=e.querySelector("h1");t&&"An error occured!"===t.innerHTML&&(console.warn("[index.main()] Crash detected..."),window.saveCommands(),clearInterval(a))}}),100)}if(window.store)Q();else{const e=window.onAppReady;window.onAppReady=()=>{e&&e(),Q()}}})(),window.setCustomGravity=function(){const e=window.store.getState().simulator.engine.getFrame(0).snapshot.entities[0].entities[0].points.length;let t=!1,r=window.store.getState().simulator.engine.engine.state.riders.length,i=0,n=0,a=[];function o(){window.store.dispatch({type:"STOP_PLAYER"}),r=window.store.getState().simulator.engine.engine.state.riders.length,i=0,n=0,window.requestAnimationFrame((()=>{window.store.getState().camera.playbackFollower._frames.length=0,window.store.getState().simulator.engine.engine._computed._frames.length=1}))}function s(){if(0===a.length)return{x:0,y:.175};let t=window.store.getState().simulator.engine.engine._computed._frames.length-1,o=a[a.length-1][1][n];if(t<a[a.length-1][0]){let e=0,r=a.length-1;for(;e<r;){let i=Math.ceil((r+e)/2);t<a[i][0]?r=i-1:e=i}o=a[e][1][n]}return void 0===o&&(o={x:0,y:.175}),i+=1,i===e&&(i=0,n+=1),n===r&&(n=0),o}return window.store.subscribe((()=>{r!==window.store.getState().simulator.engine.engine.state.riders.length&&o()})),function(e){a.length=0;for(const t of e)a.push([2400*t[0][0]+40*t[0][1]+t[0][2],t[1]]);o(),t||(t=!0,Object.defineProperty(window.$ENGINE_PARAMS,"gravity",{get:s}))}}()})();